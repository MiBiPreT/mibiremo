
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Microbiome Bioremediation Reaction Module, a Python interface to PhreeqcRM library">
      
      
        <meta name="author" content="Matteo Masi, Jaro Camphuijsen">
      
      
        <link rel="canonical" href="https://MiBiPreT.github.io/mibiremo/reference/">
      
      
        <link rel="prev" href="../examples/">
      
      
      
      <link rel="icon" href="../assets/icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>API Reference - mibiremo</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mibiremo-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="mibiremo" class="md-header__button md-logo" aria-label="mibiremo" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mibiremo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MiBiPreT/mibiremo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibiremo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../development/" class="md-tabs__link">
        
  
  
    
  
  Development

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="mibiremo" class="md-nav__button md-logo" aria-label="mibiremo" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    mibiremo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MiBiPreT/mibiremo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibiremo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibiremo" class="md-nav__link">
    <span class="md-ellipsis">
      mibiremo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.irmresult" class="md-nav__link">
    <span class="md-ellipsis">
      irmresult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="irmresult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus" class="md-nav__link">
    <span class="md-ellipsis">
      IRMStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IRMStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__bool__" class="md-nav__link">
    <span class="md-ellipsis">
      __bool__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__int__" class="md-nav__link">
    <span class="md-ellipsis">
      __int__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.raise_for_status" class="md-nav__link">
    <span class="md-ellipsis">
      raise_for_status
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRM_RESULT" class="md-nav__link">
    <span class="md-ellipsis">
      IRM_RESULT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.phreeqc" class="md-nav__link">
    <span class="md-ellipsis">
      phreeqc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="phreeqc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM" class="md-nav__link">
    <span class="md-ellipsis">
      PhreeqcRM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhreeqcRM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.get_selected_output_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_selected_output_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.initialize_phreeqc" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_phreeqc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.run_initial_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      run_initial_from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver" class="md-nav__link">
    <span class="md-ellipsis">
      semilagsolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="semilagsolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver" class="md-nav__link">
    <span class="md-ellipsis">
      SemiLagSolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SemiLagSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.cubic_spline_advection" class="md-nav__link">
    <span class="md-ellipsis">
      cubic_spline_advection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.saulyev_solver_alt" class="md-nav__link">
    <span class="md-ellipsis">
      saulyev_solver_alt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.transport" class="md-nav__link">
    <span class="md-ellipsis">
      transport
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibiremo" class="md-nav__link">
    <span class="md-ellipsis">
      mibiremo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.irmresult" class="md-nav__link">
    <span class="md-ellipsis">
      irmresult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="irmresult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus" class="md-nav__link">
    <span class="md-ellipsis">
      IRMStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IRMStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__bool__" class="md-nav__link">
    <span class="md-ellipsis">
      __bool__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__int__" class="md-nav__link">
    <span class="md-ellipsis">
      __int__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRMStatus.raise_for_status" class="md-nav__link">
    <span class="md-ellipsis">
      raise_for_status
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.irmresult.IRM_RESULT" class="md-nav__link">
    <span class="md-ellipsis">
      IRM_RESULT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.phreeqc" class="md-nav__link">
    <span class="md-ellipsis">
      phreeqc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="phreeqc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM" class="md-nav__link">
    <span class="md-ellipsis">
      PhreeqcRM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhreeqcRM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.get_selected_output_df" class="md-nav__link">
    <span class="md-ellipsis">
      get_selected_output_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.initialize_phreeqc" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_phreeqc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.phreeqc.PhreeqcRM.run_initial_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      run_initial_from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver" class="md-nav__link">
    <span class="md-ellipsis">
      semilagsolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="semilagsolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver" class="md-nav__link">
    <span class="md-ellipsis">
      SemiLagSolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SemiLagSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.cubic_spline_advection" class="md-nav__link">
    <span class="md-ellipsis">
      cubic_spline_advection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.saulyev_solver_alt" class="md-nav__link">
    <span class="md-ellipsis">
      saulyev_solver_alt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibiremo.semilagsolver.SemiLagSolver.transport" class="md-nav__link">
    <span class="md-ellipsis">
      transport
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mibiremo-api-reference"><code>mibiremo</code> API reference</h1>


<div class="doc doc-object doc-module">



<a id="mibiremo"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h2 id="mibiremo.irmresult" class="doc doc-heading">
            <code>irmresult</code>


</h2>

    <div class="doc doc-contents ">

        <p>PhreeqcRM result code mapping and error handling utilities.</p>
<p>This module provides utilities for interpreting and handling result codes returned
by PhreeqcRM operations. PhreeqcRM functions return integer status codes that
indicate success, failure, or specific error conditions. This module maps these
numeric codes to human-readable error messages for improved debugging and logging.</p>
<p>The result codes follow the PhreeqcRM C++ library conventions and correspond
to the IrmResult enumeration defined in IrmResult.h of the original PhreeqcRM
source code.</p>


<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="IRMStatus (mibiremo.irmresult.IRMStatus)" href="#mibiremo.irmresult.IRMStatus">IRMStatus</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Named tuple containing status code, name, and message with convenience methods.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="IRM_RESULT(code) (mibiremo.irmresult.IRM_RESULT)" href="#mibiremo.irmresult.IRM_RESULT">IRM_RESULT</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Maps integer error codes to IRMStatus objects with enhanced functionality.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>
        <p>References:</p>
<ul>
<li><a href="https://usgs-coupled.github.io/phreeqcrm/IrmResult_8h.html">PhreeqcRM IrmResult.h File Reference</a></li>
</ul>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="mibiremo.irmresult.IRMStatus" class="doc doc-heading">
            <code>IRMStatus</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>


        <p>PhreeqcRM status result with enhanced functionality.</p>
<p>This named tuple extends the basic error code mapping with convenience methods
for better error handling and user experience.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.irmresult.IRMStatus.code">code</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The raw integer error code from PhreeqcRM.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.irmresult.IRMStatus.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbolic name of the error code (e.g., &ldquo;IRM_OK&rdquo;, &ldquo;IRM_FAIL&rdquo;).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.irmresult.IRMStatus.message">message</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable description of the error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="quote">
                <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">class</span><span class="w"> </span><span class="nc">IRMStatus</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;PhreeqcRM status result with enhanced functionality.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    This named tuple extends the basic error code mapping with convenience methods</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    for better error handling and user experience.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        code (int): The raw integer error code from PhreeqcRM.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        name (str): Symbolic name of the error code (e.g., &quot;IRM_OK&quot;, &quot;IRM_FAIL&quot;).</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        message (str): Human-readable description of the error.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">code</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the operation was successful (code == 0).</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            &gt;&gt;&gt; if result:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            &gt;&gt;&gt;     print(&quot;Success!&quot;)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            &gt;&gt;&gt; else:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            &gt;&gt;&gt;     print(f&quot;Error: {result}&quot;)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the raw integer code for backwards compatibility.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            &gt;&gt;&gt; if int(result) == 0:  # Still works</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            &gt;&gt;&gt;     print(&quot;Success!&quot;)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a formatted string representation of the status.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            str: Formatted string in the form &quot;ERROR_NAME: Error description&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">raise_for_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise an exception if the operation failed.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            context (str, optional): Additional context for the error message.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            RuntimeError: If the status code indicates failure (non-zero).</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_LoadDatabase(&quot;invalid.dat&quot;)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            &gt;&gt;&gt; result.raise_for_status(&quot;Loading database&quot;)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            RuntimeError: Loading database: IRM_FAIL: Failure, Unspecified</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">: &quot;</span> <span class="k">if</span> <span class="n">context</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mibiremo.irmresult.IRMStatus.__bool__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__bool__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return True if the operation was successful (code == 0).</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">RM_RunCells</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">result</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="k">def</span><span class="w"> </span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the operation was successful (code == 0).</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        &gt;&gt;&gt; if result:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        &gt;&gt;&gt;     print(&quot;Success!&quot;)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        &gt;&gt;&gt; else:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        &gt;&gt;&gt;     print(f&quot;Error: {result}&quot;)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.irmresult.IRMStatus.__int__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__int__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the raw integer code for backwards compatibility.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">RM_RunCells</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Still works</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">def</span><span class="w"> </span><span class="fm">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the raw integer code for backwards compatibility.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        &gt;&gt;&gt; if int(result) == 0:  # Still works</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        &gt;&gt;&gt;     print(&quot;Success!&quot;)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.irmresult.IRMStatus.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a formatted string representation of the status.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted string in the form &ldquo;ERROR_NAME: Error description&rdquo;</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a formatted string representation of the status.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        str: Formatted string in the form &quot;ERROR_NAME: Error description&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.irmresult.IRMStatus.raise_for_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">raise_for_status</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Raise an exception if the operation failed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context for the error message.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the status code indicates failure (non-zero).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">RM_LoadDatabase</span><span class="p">(</span><span class="s2">&quot;invalid.dat&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">(</span><span class="s2">&quot;Loading database&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">RuntimeError: Loading database: IRM_FAIL: Failure, Unspecified</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">raise_for_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Raise an exception if the operation failed.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        context (str, optional): Additional context for the error message.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        RuntimeError: If the status code indicates failure (non-zero).</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; result = rm.RM_LoadDatabase(&quot;invalid.dat&quot;)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; result.raise_for_status(&quot;Loading database&quot;)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        RuntimeError: Loading database: IRM_FAIL: Failure, Unspecified</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">: &quot;</span> <span class="k">if</span> <span class="n">context</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="mibiremo.irmresult.IRM_RESULT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">IRM_RESULT</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Map PhreeqcRM integer error codes to enhanced status objects.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>code</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integer error code returned by PhreeqcRM functions.
Return codes are listed below:
- 0: Success (IRM_OK)
- -1: Out of memory error
- -2: Invalid variable type
- -3: Invalid argument
- -4: Invalid row index
- -5: Invalid column index
- -6: Invalid PhreeqcRM instance ID
- -7: Unspecified failure</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>IRMStatus</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="IRMStatus (mibiremo.irmresult.IRMStatus)" href="#mibiremo.irmresult.IRMStatus">IRMStatus</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A named tuple containing:
- code (int): The raw integer error code
- name (str): Symbolic error code name (e.g., &ldquo;IRM_OK&rdquo;, &ldquo;IRM_FAIL&rdquo;)
- message (str): Human-readable error description</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># &quot;IRM_OK: Success&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">result</span><span class="p">:</span>  <span class="c1"># True for success</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operation successful&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>  <span class="c1"># -1 (backwards compatibility)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">error</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">(</span><span class="s2">&quot;Memory allocation&quot;</span><span class="p">)</span>  <span class="c1"># Raises RuntimeError</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/irmresult.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">def</span><span class="w"> </span><span class="nf">IRM_RESULT</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IRMStatus</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Map PhreeqcRM integer error codes to enhanced status objects.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        code (int): Integer error code returned by PhreeqcRM functions.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            Return codes are listed below:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            - 0: Success (IRM_OK)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            - -1: Out of memory error</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            - -2: Invalid variable type</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            - -3: Invalid argument</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            - -4: Invalid row index</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            - -5: Invalid column index</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            - -6: Invalid PhreeqcRM instance ID</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            - -7: Unspecified failure</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        IRMStatus: A named tuple containing:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            - code (int): The raw integer error code</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            - name (str): Symbolic error code name (e.g., &quot;IRM_OK&quot;, &quot;IRM_FAIL&quot;)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            - message (str): Human-readable error description</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        &gt;&gt;&gt; result = IRM_RESULT(0)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        &gt;&gt;&gt; print(result)  # &quot;IRM_OK: Success&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        &gt;&gt;&gt; if result:  # True for success</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        &gt;&gt;&gt;     print(&quot;Operation successful&quot;)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &gt;&gt;&gt; error = IRM_RESULT(-1)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; print(int(error))  # -1 (backwards compatibility)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        &gt;&gt;&gt; error.raise_for_status(&quot;Memory allocation&quot;)  # Raises RuntimeError</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_OK&quot;</span><span class="p">,</span> <span class="s2">&quot;Success&quot;</span><span class="p">),</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_OUTOFMEMORY&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Out of memory&quot;</span><span class="p">),</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_BADVARTYPE&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Invalid VAR type&quot;</span><span class="p">),</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_INVALIDARG&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Invalid argument&quot;</span><span class="p">),</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_INVALIDROW&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Invalid row&quot;</span><span class="p">),</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_INVALIDCOL&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Invalid column&quot;</span><span class="p">),</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_BADINSTANCE&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Invalid rm instance id&quot;</span><span class="p">),</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;IRM_FAIL&quot;</span><span class="p">,</span> <span class="s2">&quot;Failure, Unspecified&quot;</span><span class="p">),</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="p">}</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">name</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">code</span><span class="p">]</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">return</span> <span class="n">IRMStatus</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">return</span> <span class="n">IRMStatus</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="s2">&quot;IRM_UNKNOWN&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown error code: </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mibiremo.phreeqc" class="doc doc-heading">
            <code>phreeqc</code>


</h2>

    <div class="doc doc-contents ">

        <p>Python interface to PhreeqcRM for geochemical reactive transport modeling.</p>
<p>PhreeqcRM is a reaction module developed by the U.S. Geological Survey (USGS)
for coupling geochemical calculations with transport models. It provides a
high-performance interface to PHREEQC geochemical modeling capabilities for
reactive transport simulations in environmental and hydrological applications.</p>
<p>PhreeqcRM enables:</p>
<ul>
<li>Multi-threaded geochemical calculations for large-scale transport models</li>
<li>Equilibrium and kinetic geochemical reactions in porous media</li>
<li>Parallel processing for computationally intensive reactive transport</li>
</ul>
<p>This interface provides a Python wrapper around the PhreeqcRM C++ library,
simplifying the process of integrating geochemical calculations with transport models.</p>
<p>All RM_* methods in this class correspond directly to PhreeqcRM C++ functions.
PhreeqcRM documentation and source code can be found at:</p>
<ul>
<li><a href="https://usgs-coupled.github.io/phreeqcrm/namespacephreeqcrm.html">PhreeqcRM Documentation</a></li>
<li><a href="https://github.com/usgs-coupled/phreeqcrm">PhreeqcRM GitHub Repository</a></li>
</ul>
<p>Last revision: 26/09/2025</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="mibiremo.phreeqc.PhreeqcRM" class="doc doc-heading">
            <code>PhreeqcRM</code>


</h3>


    <div class="doc doc-contents ">


        <p>Python interface to PhreeqcRM for geochemical reactive transport modeling.</p>
<p>This class facilitates coupling between transport codes and geochemical
reaction calculations by managing multiple reaction cells, each representing
a grid cell in the transport model. The PhreeqcRM approach allows efficient
parallel processing of geochemical calculations across large spatial domains.</p>


<details class="the-class-handles" open>
  <summary>The class handles</summary>
  <ul>
<li>Creation and initialization of PhreeqcRM instances</li>
<li>Loading thermodynamic databases (PHREEQC format)</li>
<li>Setting up initial chemical conditions from input files</li>
<li>Running equilibrium and kinetic geochemical reactions</li>
<li>Transferring concentrations between transport and reaction modules</li>
<li>Managing porosity, saturation, temperature, and pressure fields</li>
<li>Retrieving calculated properties and concentrations</li>
</ul>
</details>

<details class="typical-workflow" open>
  <summary>Typical workflow</summary>
  <ol>
<li>Create instance and call create() method to initialize with grid size</li>
<li>Load thermodynamic database with initialize_phreeqc()</li>
<li>Set initial conditions with run_initial_from_file()</li>
<li>In transport time loop:</li>
<li>Transfer concentrations to reaction module with RM_SetConcentrations()</li>
<li>Advance time with RM_SetTime() and RM_SetTimeStep()</li>
<li>Run reactions with RM_RunCells()</li>
<li>Retrieve updated concentrations with RM_GetConcentrations()</li>
</ol>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.dllpath">dllpath</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the PhreeqcRM dynamic library file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.nxyz">nxyz</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of grid cells in the reactive transport model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.n_threads">n_threads</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of threads for parallel geochemical processing.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.libc">libc</span></code></td>
            <td>
                  <code><span title="ctypes.CDLL">CDLL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Handle to the loaded PhreeqcRM dynamic library.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.id">id</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique instance identifier returned by RM_Create.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.components">components</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of component names for transport.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.phreeqc.PhreeqcRM.species">species</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of aqueous species names in the system.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This interface requires the PhreeqcRM dynamic library to be available
in the lib/ subdirectory. The library handles the underlying PHREEQC
calculations and memory management.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>See page <a href="../examples/">Examples</a> for usage examples.</p>








              <details class="quote">
                <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33">  33</a></span>
<span class="normal"><a href="#__codelineno-0-34">  34</a></span>
<span class="normal"><a href="#__codelineno-0-35">  35</a></span>
<span class="normal"><a href="#__codelineno-0-36">  36</a></span>
<span class="normal"><a href="#__codelineno-0-37">  37</a></span>
<span class="normal"><a href="#__codelineno-0-38">  38</a></span>
<span class="normal"><a href="#__codelineno-0-39">  39</a></span>
<span class="normal"><a href="#__codelineno-0-40">  40</a></span>
<span class="normal"><a href="#__codelineno-0-41">  41</a></span>
<span class="normal"><a href="#__codelineno-0-42">  42</a></span>
<span class="normal"><a href="#__codelineno-0-43">  43</a></span>
<span class="normal"><a href="#__codelineno-0-44">  44</a></span>
<span class="normal"><a href="#__codelineno-0-45">  45</a></span>
<span class="normal"><a href="#__codelineno-0-46">  46</a></span>
<span class="normal"><a href="#__codelineno-0-47">  47</a></span>
<span class="normal"><a href="#__codelineno-0-48">  48</a></span>
<span class="normal"><a href="#__codelineno-0-49">  49</a></span>
<span class="normal"><a href="#__codelineno-0-50">  50</a></span>
<span class="normal"><a href="#__codelineno-0-51">  51</a></span>
<span class="normal"><a href="#__codelineno-0-52">  52</a></span>
<span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">class</span><span class="w"> </span><span class="nc">PhreeqcRM</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Python interface to PhreeqcRM for geochemical reactive transport modeling.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    This class facilitates coupling between transport codes and geochemical</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    reaction calculations by managing multiple reaction cells, each representing</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    a grid cell in the transport model. The PhreeqcRM approach allows efficient</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    parallel processing of geochemical calculations across large spatial domains.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    The class handles:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        - Creation and initialization of PhreeqcRM instances</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        - Loading thermodynamic databases (PHREEQC format)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        - Setting up initial chemical conditions from input files</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        - Running equilibrium and kinetic geochemical reactions</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        - Transferring concentrations between transport and reaction modules</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        - Managing porosity, saturation, temperature, and pressure fields</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        - Retrieving calculated properties and concentrations</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Typical workflow:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        1. Create instance and call create() method to initialize with grid size</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        2. Load thermodynamic database with initialize_phreeqc()</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        3. Set initial conditions with run_initial_from_file()</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        4. In transport time loop:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">           - Transfer concentrations to reaction module with RM_SetConcentrations()</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">           - Advance time with RM_SetTime() and RM_SetTimeStep()</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">           - Run reactions with RM_RunCells()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">           - Retrieve updated concentrations with RM_GetConcentrations()</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        dllpath (str): Path to the PhreeqcRM dynamic library file.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        nxyz (int): Number of grid cells in the reactive transport model.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        n_threads (int): Number of threads for parallel geochemical processing.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        libc (ctypes.CDLL): Handle to the loaded PhreeqcRM dynamic library.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        id (int): Unique instance identifier returned by RM_Create.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        components (numpy.ndarray): Array of component names for transport.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        species (numpy.ndarray): Array of aqueous species names in the system.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        This interface requires the PhreeqcRM dynamic library to be available</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        in the lib/ subdirectory. The library handles the underlying PHREEQC</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        calculations and memory management.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        See page [Examples](examples.md) for usage examples.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize PhreeqcRM instance.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        Creates a new PhreeqcRM object with default values. The instance must be</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        created using the create() method before it can be used for calculations.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dllpath</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_threads</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dllpath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nxyz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a PhreeqcRM reaction module instance.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        Initializes the PhreeqcRM library, loads the dynamic library, and creates</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        a reaction module with the specified number of grid cells and threads.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        This method must be called before any other PhreeqcRM operations.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            dllpath (str, optional): Path to the PhreeqcRM library. If None,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">                uses the default library path based on the operating system.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            nxyz (int, optional): Number of grid cells in the model. Must be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                positive. Defaults to 1.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            n_threads (int, optional): Number of threads for parallel processing.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                Use -1 for automatic detection of CPU count. Defaults to 1.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            Exception: If the operating system is not supported (Windows/Linux only).</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            RuntimeError: If PhreeqcRM instance creation fails.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            &gt;&gt;&gt; rm.create(nxyz=100, n_threads=4)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">if</span> <span class="n">dllpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="c1"># If no path is provided, use the default path, based on operating system</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="n">dllpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;PhreeqcRM.dll&quot;</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="n">dllpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;PhreeqcRM.so&quot;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Operating system not supported&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dllpath</span> <span class="o">=</span> <span class="n">dllpath</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">if</span> <span class="n">n_threads</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">n_threads</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_threads</span> <span class="o">=</span> <span class="n">n_threads</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="n">nxyz</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="n">dllpath</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_Create</span><span class="p">(</span><span class="n">nxyz</span><span class="p">,</span> <span class="n">n_threads</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to create PhreeqcRM instance: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_phreeqc</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">database_path</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">units_solution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">porosity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">saturation</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">multicomponent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize PhreeqcRM with database and default parameters.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Loads a thermodynamic database and sets up the PhreeqcRM instance with</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        standard parameters for geochemical calculations. This is a convenience</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        method that handles common initialization tasks.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            database_path (str): Path to the PHREEQC database file (.dat format).</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                Common databases include phreeqc.dat, Amm.dat, pitzer.dat.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            units_solution (int, optional): Units for solution concentrations.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                1 = mol/L, 2 = mmol/L, 3 = μmol/L. Defaults to 2.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            units (int, optional): Units for other phases (Exchange, Surface,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">                Gas, Solid solutions, Kinetics). Defaults to 1.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            porosity (float, optional): Porosity value assigned to all cells.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">                Must be between 0 and 1. Defaults to 1.0.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            saturation (float, optional): Saturation value assigned to all cells.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                Must be between 0 and 1. Defaults to 1.0.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            multicomponent (bool, optional): Enable multicomponent diffusion</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                by saving species concentrations. Defaults to True.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            RuntimeError: If the PhreeqcRM instance is not initialized or if</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                the database fails to load.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            &gt;&gt;&gt; rm.create(nxyz=100)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            &gt;&gt;&gt; rm.initialize_phreeqc(&quot;phreeqc.dat&quot;, units_solution=1)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;PhreeqcRM instance not initialized. Call create() first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="c1"># Load database</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_LoadDatabase</span><span class="p">(</span><span class="n">database_path</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load Phreeqc database: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="c1"># Set properties/parameters</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetComponentH2O</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Don&#39;t include H2O in component list</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetRebalanceFraction</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Rebalance thread load</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="c1"># Set units</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSolution</span><span class="p">(</span><span class="n">units_solution</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsPPassemblage</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsExchange</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSurface</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsGasPhase</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSSassemblage</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsKinetics</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="c1"># Set porosity and saturation</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetPorosity</span><span class="p">(</span><span class="n">porosity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">))</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetSaturation</span><span class="p">(</span><span class="n">saturation</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">))</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># Create error log files</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetFilePrefix</span><span class="p">(</span><span class="s2">&quot;phr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_OpenFiles</span><span class="p">()</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="c1"># Multicomponent diffusion settings</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">if</span> <span class="n">multicomponent</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetSpeciesSaveOn</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_initial_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pqi_file</span><span class="p">,</span> <span class="n">ic</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up initial conditions from PHREEQC input file and initial conditions array.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        Loads initial geochemical conditions by running a PHREEQC input file and</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        mapping the defined solutions, phases, and other components to the grid cells.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        This method also retrieves component and species information for later use.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            pqi_file (str): Path to the PHREEQC input file (.pqi format) containing</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">                definitions for solutions, equilibrium phases, exchange, surface,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">                gas phases, solid solutions, and kinetic reactions.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            ic (numpy.ndarray): Initial conditions array with shape (nxyz, 7) where</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                each row corresponds to a grid cell and columns represent:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">                - Column 0: Solution ID</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">                - Column 1: Equilibrium phase ID</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">                - Column 2: Exchange ID</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                - Column 3: Surface ID</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">                - Column 4: Gas phase ID</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">                - Column 5: Solid solution ID</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">                - Column 6: Kinetic reaction ID</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">                Use -1 for unused components.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            RuntimeError: If the PHREEQC input file fails to run.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            ValueError: If initial conditions array has incorrect shape or cannot</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">                be converted to integer array.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            &gt;&gt;&gt; ic = np.array([[1, -1, -1, -1, -1, -1, -1]])  # Only solution 1</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            &gt;&gt;&gt; rm.run_initial_from_file(&quot;initial.pqi&quot;, ic)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="c1"># Run the initial setup file</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_RunFile</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pqi_file</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to run Phreeqc input file: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="c1"># Check size of initial conditions array</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">if</span> <span class="n">ic</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial conditions array must have shape (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="si">}</span><span class="s2">, 7), got </span><span class="si">{</span><span class="n">ic</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="c1"># Be sure that ic is a numpy array</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Initial conditions must be convertible to a numpy array of integers&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Reshape initial conditions to 1D array</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">ic1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># ic2 contains numbers for a second entity that mixes with the first entity (here, it is not used)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">ic2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="c1"># f1 contains the fractions of the first entity in each cell (here, it is set to 1.0)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_InitialPhreeqc2Module</span><span class="p">(</span><span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="c1"># Get component and species information</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">n_comps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_FindComponents</span><span class="p">()</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">n_species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSpeciesCount</span><span class="p">()</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U20&quot;</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comps</span><span class="p">):</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetComponent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_species</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U20&quot;</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_species</span><span class="p">):</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSpeciesName</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="c1"># Run initial equilibrium step</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetTime</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetTimeStep</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_RunCells</span><span class="p">()</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_selected_output_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve selected output data as a pandas DataFrame.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        Extracts the current selected output data from PhreeqcRM and formats it</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        as a pandas DataFrame with appropriate column headers. Selected output</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        typically includes calculated properties like pH, pe, ionic strength,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        activities, saturation indices, and user-defined calculations.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            pandas.DataFrame: DataFrame containing selected output data with</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                rows representing grid cells and columns representing the</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                selected output variables defined in the PHREEQC input.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            &gt;&gt;&gt; df = rm.get_selected_output_df()</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            &gt;&gt;&gt; print(df.columns)  # Show available output variables</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            &gt;&gt;&gt; print(df[&#39;pH&#39;])     # Access pH values for all cells</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="c1"># Get selected ouput headings</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">ncolsel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutputColumnCount</span><span class="p">()</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">selout_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U100&quot;</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">):</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutputHeading</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">selout_h</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">so</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncolsel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span> <span class="n">ncolsel</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutput</span><span class="p">(</span><span class="n">so</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">selout_h</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1">### PhreeqcRM functions</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_Abort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">err_str</span><span class="p">):</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Abort the PhreeqcRM run.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            result (int): Error code indicating reason for abort.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            err_str (str): Error message string.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_Abort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">err_str</span><span class="p">))</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_CloseFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Close output files opened by RM_OpenFiles.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        Closes all output files that were opened by RM_OpenFiles, including</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        error logs and debug files. This method should be called before</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        destroying the PhreeqcRM instance to ensure proper file cleanup.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            &gt;&gt;&gt; rm.RM_OpenFiles()  # Open files for logging</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            &gt;&gt;&gt; # ... perform calculations ...</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_CloseFiles()  # Close files when done</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            &gt;&gt;&gt; if not result:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            &gt;&gt;&gt;     print(f&quot;Warning: {result}&quot;)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_CloseFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_Concentrations2Utility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">p_atm</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transfer concentrations from a cell to the utility IPhreeqc instance.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Transfers solution concentrations from a reaction cell to the utility</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        IPhreeqc instance for further calculations or analysis. This method</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        allows access to the full PHREEQC functionality for individual cells.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            c (numpy.ndarray): Array of component concentrations to transfer.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            n (int): Cell number from which to transfer concentrations.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            tc (float): Temperature in Celsius for the utility calculation.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            p_atm (float): Pressure in atmospheres for the utility calculation.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_Concentrations2Utility</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">p_atm</span><span class="p">))</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_CreateMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid2chem</span><span class="p">):</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a mapping from grid cells to reaction cells.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Establishes the relationship between transport grid cells and reaction</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        cells, allowing for optimization when multiple grid cells share the</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        same chemical composition. This can significantly reduce computational</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        requirements for large models with repeating chemical conditions.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">            grid2chem (numpy.ndarray): Array mapping grid cells to reaction cells.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">                Length should equal the number of grid cells in the transport model.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">                Values are indices of reaction cells (0-based).</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            After calling this method, the number of reaction cells may be</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            different from the number of grid cells, potentially reducing</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            computational overhead.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_CreateMapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">grid2chem</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_DecodeError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Decode error code to human-readable message.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Converts a numeric error code returned by PhreeqcRM functions into</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        a descriptive error message string for debugging and logging purposes.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            e (int): Error code to decode.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            str: Human-readable error message corresponding to the error code.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">            &gt;&gt;&gt; if not result:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            &gt;&gt;&gt;     error_msg = rm.RM_DecodeError(result.code)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            &gt;&gt;&gt;     print(f&quot;Error: {error_msg}&quot;)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_DecodeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_Destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Destroy a PhreeqcRM instance and free all associated memory.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Deallocates all memory associated with the PhreeqcRM instance, including</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        reaction cells, species data, and internal data structures. This method</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        should be called when the PhreeqcRM instance is no longer needed to</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        prevent memory leaks.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        Warning:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            After calling this method, the PhreeqcRM instance should not be</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            used for any further operations. All method calls will fail.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            &gt;&gt;&gt; rm.create(nxyz=100)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            &gt;&gt;&gt; # ... use PhreeqcRM instance ...</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            &gt;&gt;&gt; rm.RM_Destroy()  # Clean up when finished</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_Destroy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_DumpModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dump_on</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable dumping of reaction module data to file.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        Controls the output of detailed reaction module data to a dump file</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        for debugging and analysis purposes. The dump file contains complete</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        information about the state of all reaction cells.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            dump_on (int): Enable (1) or disable (0) dump file creation.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            append (int): Append to existing file (1) or overwrite (0).</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            The dump file name is set by RM_SetDumpFileName(). If no name</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            is set, a default name will be used.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_DumpModule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dump_on</span><span class="p">,</span> <span class="n">append</span><span class="p">))</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_ErrorMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">errstr</span><span class="p">):</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print an error message to the error output file.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        Writes an error message to the PhreeqcRM error log file. The message</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        is formatted with timestamp and process information for debugging.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            errstr (str): Error message string to write to the log.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            Error logging must be enabled with RM_OpenFiles() for messages</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">            to be written to file.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_ErrorMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">errstr</span><span class="p">))</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_FindComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find and count components for transport calculations.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Analyzes all chemical definitions in the reaction module to determine</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        the minimum set of components (elements plus charge) required for</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        transport calculations. This method must be called after initial</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        conditions are set but before starting transport calculations.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        The components identified include:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            - Chemical elements present in the system</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            - Electric charge balance</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            - Isotopes if defined in the database</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            int: Number of components required for transport calculations.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">                This defines the number of concentrations that must be</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">                transported for each grid cell.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">            This method should be called after RM_InitialPhreeqc2Module()</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            and before beginning transport time stepping. The returned</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            count determines array sizes for concentration transfers.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            &gt;&gt;&gt; rm.run_initial_from_file(&quot;initial.pqi&quot;, ic_array)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            &gt;&gt;&gt; ncomp = rm.RM_FindComponents()</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Transport requires {ncomp} components&quot;)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_FindComponents</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetBackwardMapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get backward mapping from reaction cells to grid cells.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        Retrieves the list of grid cell numbers that map to a specific</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        reaction cell. This is the inverse of the forward mapping and is</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        useful for distributing reaction cell results back to grid cells.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            n (int): Reaction cell number for which to get the mapping.</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            list (numpy.ndarray): Array to receive grid cell numbers that</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">                map to the specified reaction cell.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">            size (int): Size of the list array.</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">                The number of grid cells mapping to reaction cell n.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetBackwardMapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetChemistryCellCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of reaction cells in the module.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Returns the number of reaction cells currently defined in the</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        PhreeqcRM instance. This may be different from the number of</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        grid cells if a mapping has been created to reduce computational</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        requirements by grouping cells with identical chemistry.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            int: Number of reaction cells in the module.</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            Without cell mapping, this equals the number of grid cells.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            With mapping, this may be significantly smaller, improving</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            computational efficiency.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetChemistryCellCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">chem_name</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of a component by index.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        Retrieves the name of a transport component identified by its index.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        Components are the chemical entities that must be transported in</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        reactive transport simulations, typically elements plus charge.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            num (int): Index of the component (0-based).</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            chem_name (numpy.ndarray): String array to store component names.</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">                The name will be stored at index num.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">            length (int): Maximum length of the component name string.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            This method is typically used in a loop to retrieve all component</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">            names after calling RM_FindComponents().</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">String</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">chem_name</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve component concentrations from reaction cells.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        Extracts current component concentrations from all reaction cells</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        after geochemical calculations. These concentrations represent the</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        dissolved components that must be transported in reactive transport</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        simulations.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">            c (numpy.ndarray): Array to receive concentrations with shape</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">                (nxyz * ncomps). Will be filled with current concentrations</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">                in the units specified by RM_SetUnitsSolution().</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            The array is organized with all components for cell 0, followed</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            by all components for cell 1, etc. Use this method after</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            RM_RunCells() to get updated concentrations for transport.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">            &gt;&gt;&gt; ncomp = rm.RM_GetComponentCount()</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">            &gt;&gt;&gt; conc = np.zeros(nxyz * ncomp)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_GetConcentrations(conc)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">            &gt;&gt;&gt; if result:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            &gt;&gt;&gt;     # Reshape to (nxyz, ncomp) for easier handling</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            &gt;&gt;&gt;     conc_2d = conc.reshape(nxyz, ncomp)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">density</span><span class="p">):</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get solution density for all reaction cells.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        Retrieves the calculated solution density for each reaction cell</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        based on the current chemical composition, temperature, and pressure.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        Densities are calculated using the thermodynamic database properties.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">            density (numpy.ndarray): Array to receive density values with</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">                length equal to the number of reaction cells. Units are kg/L.</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">            Density calculations depend on the thermodynamic database and</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            the specific solution composition. This method should be called</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            after RM_RunCells() to get current density values.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">density</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetEndCell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ec</span><span class="p">):</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the ending cell number for the current MPI process.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">        In parallel (MPI) calculations, each process handles a subset of</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        reaction cells. This method returns the index of the last cell</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        handled by the current MPI process.</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">            ec (ctypes pointer): Pointer to receive the ending cell index.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            For single-process calculations, this typically returns nxyz-1.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            For MPI calculations, the range [start_cell, end_cell] defines</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">            the cells handled by the current process.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetEndCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ec</span><span class="p">))</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetEquilibriumPhaseCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of equilibrium phases defined in the system.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">        Returns the count of mineral phases that can potentially precipitate</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        or dissolve based on the thermodynamic database and initial conditions</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        defined in the PhreeqcRM instance.</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            int: Number of equilibrium phases defined in the system.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            This count includes all phases that have been referenced in</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            EQUILIBRIUM_PHASES blocks in the initial conditions, regardless</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            of whether they are currently present in any cells.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetEquilibriumPhaseCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetEquilibriumPhaseName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of an equilibrium phase by index.</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        Retrieves the name of a mineral phase that can precipitate or dissolve</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        in the geochemical system, identified by its index.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            num (int): Index of the equilibrium phase (0-based).</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            name (ctypes pointer): Buffer to receive the phase name.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            l1 (int): Maximum length of the name buffer.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetEquilibriumPhaseName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">))</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetErrorString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">errstr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current error string from PhreeqcRM.</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        Retrieves the most recent error message generated by PhreeqcRM</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        operations. This provides detailed information about the last</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        error that occurred during calculations.</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">            errstr (ctypes pointer): Buffer to receive the error string.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">            length (int): Maximum length of the error string buffer.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetErrorString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">errstr</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetErrorStringLength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the length of the current error string.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        Returns the length of the error message string that can be retrieved</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">        with RM_GetErrorString(). Use this to allocate appropriate buffer</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        size before calling RM_GetErrorString().</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">            int: Length of the current error string in characters.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetErrorStringLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetExchangeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetExchangeName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetExchangeSpeciesCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetExchangeSpeciesCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetExchangeSpeciesName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetExchangeSpeciesName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetFilePrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetFilePrefix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">prefix</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetGasComponentsCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetGasComponentsCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetGasComponentsName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nun</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetGasComponentsName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">nun</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetGfw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gfw</span><span class="p">):</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get gram formula weights for transport components.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        Retrieves the gram formula weights (molecular weights) for all</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        transport components. These weights are used to convert between</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">        molar and mass-based concentrations in transport calculations.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">            gfw (numpy.ndarray): Array to receive gram formula weights.</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">                Length should equal the number of components. Units are g/mol.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            The gram formula weights correspond to the components identified</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            by RM_FindComponents() and can be retrieved by RM_GetComponent().</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetGfw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">gfw</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetGridCellCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of grid cells in the model.</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">        Returns the total number of grid cells defined for the transport</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">        model, as specified when the PhreeqcRM instance was created.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            int: Number of grid cells in the transport model.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            This is the nxyz parameter that was passed to RM_Create().</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">            It represents the total number of cells in the transport grid,</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">            which may be different from the number of reaction cells if</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            cell mapping is used.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetGridCellCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetIPhreeqcId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetIPhreeqcId</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetKineticReactionsCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetKineticReactionsCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetKineticReactionsName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetKineticReactionsName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetMpiMyself</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetMpiMyself</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetMpiTasks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetMpiTasks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetNthSelectedOutputUserNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetNthSelectedOutputUserNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSaturation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat_calc</span><span class="p">):</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get saturation values for all reaction cells.</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        Retrieves the current saturation values for all reaction cells.</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        Saturation represents the fraction of pore space occupied by water</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        and affects the volume calculations in reactive transport.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">            sat_calc (numpy.ndarray): Array to receive saturation values.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">                Length should equal the number of reaction cells.</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">                Values range from 0 to 1.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSaturation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sat_calc</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSelectedOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">so</span><span class="p">):</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve selected output data from all reaction cells.</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        Extracts the current selected output data, which includes calculated</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        properties such as pH, pe, ionic strength, mineral saturation indices,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">        species activities, and user-defined calculations specified in the</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        PHREEQC input files.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">            so (numpy.ndarray): Array to receive selected output data with</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">                shape (nxyz, ncol) where ncol is the number of selected</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">                output columns defined in the PHREEQC input.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            Use RM_GetSelectedOutputColumnCount() to determine the number</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            of columns and RM_GetSelectedOutputHeading() to get column names.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            The get_selected_output_df() method provides a more convenient pandas</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            DataFrame interface to this data.</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSelectedOutput</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetNthSelectedOutputColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetNthSelectedOutputColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSelectedOutputCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSelectedOutputCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSelectedOutputHeading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>        <span class="n">String</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSelectedOutputHeading</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="n">headings</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSelectedOutputColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of columns in selected output.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            int: Number of selected output columns.</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSelectedOutputColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSelectedOutputRowCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of rows in selected output.</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">            int: Number of selected output rows.</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSelectedOutputRowCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSICount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSICount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSIName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSIName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSolidSolutionComponentsCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSolidSolutionComponentsCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSolidSolutionComponentsName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSolidSolutionComponentsName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSolidSolutionName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSolidSolutionName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSolutionVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vol</span><span class="p">):</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSolutionVolume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">vol</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species_conc</span><span class="p">):</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve aqueous species concentrations from reaction cells.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        Extracts the concentrations of individual aqueous species from all</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        reaction cells. This provides more detailed chemical information than</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        component concentrations, including the speciation of dissolved elements.</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            species_conc (numpy.ndarray): Array to receive species concentrations</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">                with shape (nxyz * nspecies). Species concentrations are in</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">                the same units as solution concentrations (mol/L, mmol/L, or μmol/L).</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">            Species saving must be enabled with RM_SetSpeciesSaveOn(1) before</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">            this method can be used. Use RM_GetSpeciesCount() to determine the</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">            number of species and RM_GetSpeciesName() to get species names.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetSpeciesSaveOn(1)  # Enable species saving</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">            &gt;&gt;&gt; rm.RM_RunCells()  # Run reactions</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">            &gt;&gt;&gt; nspecies = rm.RM_GetSpeciesCount()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">            &gt;&gt;&gt; species_c = np.zeros(nxyz * nspecies)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">            &gt;&gt;&gt; rm.RM_GetSpeciesConcentrations(species_c)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">species_conc</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of aqueous species in the geochemical system.</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        Returns the total number of dissolved aqueous species that can exist</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        in the current geochemical system based on the loaded thermodynamic</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        database and the chemical components present in the system.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">            int: Number of aqueous species defined in the system. This includes</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">                primary species (elements and basis species) and secondary species</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">                (complexes) formed from the primary species.</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            The species count is determined after loading the database and</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">            running initial equilibrium calculations. Species names can be</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">            retrieved using RM_GetSpeciesName() with indices from 0 to count-1.</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">            &gt;&gt;&gt; nspecies = rm.RM_GetSpeciesCount()</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;System contains {nspecies} aqueous species&quot;)</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            &gt;&gt;&gt; # Get all species names</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">            &gt;&gt;&gt; species_names = np.zeros(nspecies, dtype=&#39;U20&#39;)</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">            &gt;&gt;&gt; for i in range(nspecies):</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_GetSpeciesName(i, species_names, 20)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesD25</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diffc</span><span class="p">):</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get diffusion coefficients at 25°C for all aqueous species.</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        Retrieves the reference diffusion coefficients (at 25°C in water)</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        for all aqueous species in the system. These values are used in</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        multicomponent diffusion calculations in reactive transport models.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">            diffc (numpy.ndarray): Array to receive diffusion coefficients</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">                with length equal to the number of species. Units are m²/s.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            Diffusion coefficients are taken from the thermodynamic database.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            For transport at different temperatures, these values should be</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">            corrected using appropriate temperature relationships.</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesD25</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">diffc</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesLog10Gammas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species_log10gammas</span><span class="p">):</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get log10 activity coefficients for all aqueous species.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        Retrieves the base-10 logarithm of activity coefficients for all</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        aqueous species in each reaction cell. Activity coefficients account</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        for non-ideal solution behavior and are used to calculate activities</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        from concentrations.</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            species_log10gammas (numpy.ndarray): Array to receive log10 activity</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">                coefficients with shape (nxyz * nspecies). Values are dimensionless.</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            Activity coefficients depend on ionic strength, temperature, and</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            the activity model used in the thermodynamic database (e.g.,</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">            Debye-Hückel, Pitzer, SIT). Species saving must be enabled.</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesLog10Gammas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">species_log10gammas</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">chem_name</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of an aqueous species by index.</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">        Retrieves the name of an aqueous species identified by its index.</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        Species names follow PHREEQC conventions and include charge states</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        for ionic species.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">            num (int): Index of the species (0-based).</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">            chem_name (numpy.ndarray): String array to store species names.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">                The name will be stored at index num.</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">            length (int): Maximum length of the species name string.</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">            &gt;&gt;&gt; nspecies = rm.RM_GetSpeciesCount()</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">            &gt;&gt;&gt; species_names = np.zeros(nspecies, dtype=&#39;U20&#39;)</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">            &gt;&gt;&gt; for i in range(nspecies):</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_GetSpeciesName(i, species_names, 20)</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">            &gt;&gt;&gt; print(species_names)  # [&#39;H2O&#39;, &#39;H+&#39;, &#39;OH-&#39;, &#39;Ca+2&#39;, ...]</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="n">String</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="n">chem_name</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesSaveOn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if species concentration saving is enabled.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        Returns the current setting for species concentration saving. When</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        enabled, PhreeqcRM calculates and stores individual species</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        concentrations that can be retrieved with RM_GetSpeciesConcentrations().</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            int: 1 if species saving is enabled, 0 if disabled.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            Species saving increases memory usage and computation time but</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">            provides detailed speciation information useful for analysis</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            and multicomponent diffusion calculations.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesSaveOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSpeciesZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get charge values for all aqueous species.</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        Retrieves the electric charge (valence) for each aqueous species</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        in the system. Charge values are essential for electrostatic</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        calculations and charge balance constraints.</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">            Z (numpy.ndarray): Array to receive charge values with length</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">                equal to the number of species. Values are dimensionless</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">                (e.g., +2 for Ca+2, -1 for Cl-, 0 for neutral species).</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">            Charge values are defined in the thermodynamic database and</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">            are used in activity coefficient calculations and electroneutrality</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            constraints.</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSpeciesZ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetStartCell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sc</span><span class="p">):</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetStartCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSurfaceName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSurfaceName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetSurfaceType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">):</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetSurfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetThreadCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetThreadCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current simulation time.</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        Returns the current time in the reactive transport simulation.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        This time is used for kinetic rate calculations and time-dependent</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        boundary conditions.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">            float: Current simulation time in user-defined units (typically</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">                seconds, days, or years depending on the model setup).</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">            The simulation time is set by RM_SetTime() and is used internally</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            by PhreeqcRM for kinetic calculations. The time units should be</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            consistent with kinetic rate constants in the database.</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            &gt;&gt;&gt; current_time = rm.RM_GetTime()</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Current simulation time: {current_time} days&quot;)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTime</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetTimeConversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTimeConversion</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTimeConversion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetTimeStep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current time step duration.</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">        Returns the duration of the current time step used for kinetic</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">        calculations and time-dependent processes in the geochemical system.</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            float: Current time step duration in user-defined units (typically</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">                seconds, days, or years consistent with the simulation time units).</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">            The time step is set by RM_SetTimeStep() and affects the integration</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            of kinetic rate equations. Smaller time steps provide more accurate</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            solutions but require more computational time.</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            &gt;&gt;&gt; dt = rm.RM_GetTimeStep()</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Current time step: {dt} days&quot;)</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTimeStep</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetTimeStep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_InitialPhreeqc2Module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">,</span> <span class="n">f1</span><span class="p">):</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transfer initial conditions from InitialPhreeqc to reaction module.</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            ic1 (numpy.ndarray): Initial condition indices for primary entities.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            ic2 (numpy.ndarray): Initial condition indices for secondary entities.</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            f1 (numpy.ndarray): Mixing fractions for primary entities.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">            int: IRM_RESULT status code (0 for success).</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_InitialPhreeqc2Module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ic1</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span> <span class="n">ic2</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_InitialPhreeqc2Concentrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n_boundary</span><span class="p">,</span> <span class="n">boundary_solution1</span><span class="p">,</span> <span class="n">boundary_solution2</span><span class="p">,</span> <span class="n">fraction1</span><span class="p">):</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_InitialPhreeqc2Concentrations</span><span class="p">(</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span> <span class="n">n_boundary</span><span class="p">,</span> <span class="n">boundary_solution1</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span> <span class="n">boundary_solution2</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span> <span class="n">fraction1</span><span class="o">.</span><span class="n">ctypes</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="p">)</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_InitialPhreeqc2SpeciesConcentrations</span><span class="p">(</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">species_c</span><span class="p">,</span> <span class="n">n_boundary</span><span class="p">,</span> <span class="n">boundary_solution1</span><span class="p">,</span> <span class="n">boundary_solution2</span><span class="p">,</span> <span class="n">fraction1</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>    <span class="p">):</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_InitialPhreeqc2SpeciesConcentrations</span><span class="p">(</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="n">species_c</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>            <span class="n">n_boundary</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>            <span class="n">boundary_solution1</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>            <span class="n">boundary_solution2</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>            <span class="n">fraction1</span><span class="o">.</span><span class="n">ctypes</span><span class="p">,</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>        <span class="p">)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_InitialPhreeqcCell2Module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">module_numbers</span><span class="p">,</span> <span class="n">dim_module_numbers</span><span class="p">):</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_InitialPhreeqcCell2Module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">module_numbers</span><span class="p">,</span> <span class="n">dim_module_numbers</span><span class="p">)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_LoadDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_name</span><span class="p">):</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a thermodynamic database for geochemical calculations.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        Loads a PHREEQC-format thermodynamic database containing thermodynamic</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">        data for aqueous species, minerals, gases, and other phases. The database</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">        defines the chemical system and enables geochemical calculations.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            db_name (str): Path to the database file. Common databases include:</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">                - &quot;phreeqc.dat&quot;: Standard PHREEQC database (25°C)</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">                - &quot;Amm.dat&quot;: Extended database with ammonia species</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">                - &quot;pitzer.dat&quot;: Pitzer interaction parameter database</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">                - &quot;sit.dat&quot;: Specific ion interaction theory database</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            RuntimeError: If the database file cannot be found or loaded.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            This method must be called before setting up initial conditions</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            or running calculations. The database determines which species,</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">            minerals, and reactions are available for calculations.</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">            &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            &gt;&gt;&gt; rm.create(nxyz=100)</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_LoadDatabase(&quot;phreeqc.dat&quot;)</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            &gt;&gt;&gt; if not result:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            &gt;&gt;&gt;     raise RuntimeError(f&quot;Failed to load database: {result}&quot;)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_LoadDatabase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">db_name</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_LogMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_LogMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_MpiWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_MpiWorker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_MpiWorkerBreak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_MpiWorkerBreak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_OpenFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open output files for logging, debugging, and error reporting.</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        Creates and opens output files for PhreeqcRM logging, error messages,</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        and debugging information. File names are based on the prefix set</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">        by RM_SetFilePrefix().</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">        Files created:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">            - {prefix}.log: General log messages and information</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">            - {prefix}.err: Error messages and warnings</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">            - {prefix}.out: PHREEQC output from calculations</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">            Call RM_SetFilePrefix() before this method to set the file name</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">            prefix. Use RM_CloseFiles() to properly close files when finished.</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetFilePrefix(&quot;simulation&quot;)</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">            &gt;&gt;&gt; rm.RM_OpenFiles()  # Creates simulation.log, simulation.err, etc.</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">            &gt;&gt;&gt; # ... run calculations ...</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">            &gt;&gt;&gt; rm.RM_CloseFiles()  # Clean up</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_OpenFiles</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_OutputMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_OutputMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_RunCells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run geochemical reactions for all reaction cells.</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">        Performs equilibrium speciation and kinetic reactions for the current</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        time step in all reaction cells. This is the core computational method</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        that updates chemical compositions based on thermodynamic equilibrium</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        and reaction kinetics.</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">        The method performs:</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">            - Aqueous speciation calculations</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">            - Mineral precipitation/dissolution equilibrium</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">            - Ion exchange equilibrium</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">            - Surface complexation equilibrium</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">            - Gas phase equilibrium</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">            - Kinetic reaction integration over the time step</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">            Before calling this method, ensure that:</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">            - Concentrations are set with RM_SetConcentrations()</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">            - Current time is set with RM_SetTime()</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">            - Time step is set with RM_SetTimeStep()</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">            - Temperature and pressure are set if needed</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetConcentrations(concentrations)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetTime(current_time)</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetTimeStep(dt)</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_RunCells()</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">            &gt;&gt;&gt; if result:</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_GetConcentrations(updated_concentrations)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">            &gt;&gt;&gt; else:</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">            &gt;&gt;&gt;     print(f&quot;Reaction failed: {result}&quot;)</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_RunCells</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_RunFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">,</span> <span class="n">chem_name</span><span class="p">):</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a PHREEQC input file in specified PhreeqcRM instances.</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">        Executes a PHREEQC input file (.pqi format) in one or more PhreeqcRM</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">        instances. This is used to define initial conditions, equilibrium phases,</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">        exchange assemblages, surface complexation sites, gas phases, solid</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">        solutions, and kinetic reactions.</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">            workers (int): Run in worker instances (1) or not (0). Worker instances</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">                handle the main geochemical calculations for reaction cells.</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">            initial_phreeqc (int): Run in initial PhreeqcRM instance (1) or not (0).</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">                Used for defining initial chemical conditions and templates.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">            utility (int): Run in utility instance (1) or not (0). Utility instance</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">                provides access to full PHREEQC functionality for special calculations.</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">            chem_name (str): Path to the PHREEQC input file containing chemical</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">                definitions and calculations.</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">            PHREEQC input files define the chemical system using standard PHREEQC</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">            syntax. Common blocks include SOLUTION, EQUILIBRIUM_PHASES, EXCHANGE,</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">            SURFACE, GAS_PHASE, SOLID_SOLUTIONS, KINETICS, and SELECTED_OUTPUT.</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">            &gt;&gt;&gt; # Run initial conditions file in initial PhreeqcRM instance</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_RunFile(0, 1, 0, &quot;initial_conditions.pqi&quot;)</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">            &gt;&gt;&gt; if not result:</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">            &gt;&gt;&gt;     print(f&quot;Error running initial conditions file: {result}&quot;)</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_RunFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">,</span> <span class="n">chem_name</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_RunString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">,</span> <span class="n">input_string</span><span class="p">):</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run PHREEQC input from a string in specified instances.</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        Executes PHREEQC input commands provided as a string in one or more</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">        PhreeqcRM instances. This allows dynamic generation of PHREEQC input</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        without creating temporary files.</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">            workers (int): Run in worker instances (1) or not (0).</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            initial_phreeqc (int): Run in initial PhreeqcRM instance (1) or not (0).</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">            utility (int): Run in utility instance (1) or not (0).</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            input_string (str): PHREEQC input commands as a string, using</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">                standard PHREEQC syntax with newline separators.</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">            &gt;&gt;&gt; phreeqc_input = &#39;&#39;&#39;</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">            &gt;&gt;&gt; SOLUTION 1</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">            &gt;&gt;&gt;     pH 7.0</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">            &gt;&gt;&gt;     Ca 1.0</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">            &gt;&gt;&gt;     Cl 2.0</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">            &gt;&gt;&gt; END</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">            &gt;&gt;&gt; &#39;&#39;&#39;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">            &gt;&gt;&gt; rm.RM_RunString(0, 1, 0, phreeqc_input)</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_RunString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">,</span> <span class="n">input_string</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_ScreenMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_ScreenMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetComponentH2O</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tf</span><span class="p">):</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set whether to include H2O as a transport component.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">        Controls whether water (H2O) is included in the list of components</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">        that must be transported in reactive transport simulations. This</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">        setting affects the component count and transport requirements.</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">            tf (int): Include H2O as a component:</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">                1 = Include H2O as a transport component</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">                0 = Exclude H2O from transport components (default)</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">            Typically, H2O is not transported as a separate component because</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">            water content is determined by porosity, saturation, and density.</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            Including H2O increases the number of transport equations but may</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">            be necessary for some specialized applications.</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetComponentH2O(0)  # Standard: don&#39;t transport H2O</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">            &gt;&gt;&gt; ncomp = rm.RM_FindComponents()  # Get component count</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetComponentH2O</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tf</span><span class="p">))</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set component concentrations for all reaction cells.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">        Transfers concentration data from the transport model to the reaction</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">        module. This method is typically called at each transport time step</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">        to provide updated concentrations for geochemical calculations.</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">            c (numpy.ndarray): Concentration array with shape (nxyz * ncomps)</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">                containing concentrations for all cells and components.</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">                Concentrations must be in the units specified by RM_SetUnitsSolution().</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">                Array is organized with all components for cell 0, followed by</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">                all components for cell 1, etc.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">            This method sets the starting concentrations for the next call to</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">            RM_RunCells(). The concentrations are used as initial conditions</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">            for equilibrium and kinetic calculations.</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">            &gt;&gt;&gt; # Transport model updates concentrations</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            &gt;&gt;&gt; new_conc = transport_step(old_conc, velocity, dt)</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            &gt;&gt;&gt; # Transfer to reaction module</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">            &gt;&gt;&gt; result = rm.RM_SetConcentrations(new_conc.flatten())</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">            &gt;&gt;&gt; if result:</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_RunCells()  # Run geochemical reactions</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetConcentrations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetCurrentSelectedOutputUserNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_user</span><span class="p">):</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetCurrentSelectedOutputUserNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">n_user</span><span class="p">)</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">density</span><span class="p">):</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">density</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetDumpFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dump_name</span><span class="p">):</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetDumpFileName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dump_name</span><span class="p">)</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetErrorHandlerMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetErrorHandlerMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetFilePrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set prefix for output files.</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">            prefix (str): Prefix string for output file names.</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">            int: IRM_RESULT status code (0 for success).</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetFilePrefix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">prefix</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetMpiWorkerCallbackCookie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cookie</span><span class="p">):</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetMpiWorkerCallbackCookie</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetPartitionUZSolids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tf</span><span class="p">):</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetPartitionUZSolids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">por</span><span class="p">):</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set porosity values for all grid cells.</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">        Defines the porosity (void fraction) for each grid cell, which</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        represents the fraction of bulk volume occupied by pore space.</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        Porosity affects volume calculations for concentration conversions</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">        and reaction extent calculations.</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">            por (numpy.ndarray): Array of porosity values for each cell.</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">                Length should equal the number of grid cells (nxyz).</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">                Values must be between 0 and 1, where:</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">                - 0 = no pore space (solid rock)</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">                - 1 = completely porous (pure fluid)</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">                - Typical values: 0.1-0.4 for sedimentary rocks</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">            Porosity is used with saturation to calculate the water volume</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">            in each cell: water_volume = porosity × saturation × bulk_volume.</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">            This affects concentration calculations and reaction stoichiometry.</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">            &gt;&gt;&gt; porosity = np.full(nxyz, 0.25)  # 25% porosity for all cells</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetPorosity(porosity)</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetPorosity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">por</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetPressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetPressure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetPrintChemistryMask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_mask</span><span class="p">):</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetPrintChemistryMask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">cell_mask</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetPrintChemistryOn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">):</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetPrintChemistryOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">initial_phreeqc</span><span class="p">,</span> <span class="n">utility</span><span class="p">)</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetRebalanceByCell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetRebalanceByCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetRebalanceFraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set load balancing algorithm fraction.</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">            f (float): Fraction for load balancing (typically 0.5).</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">            int: IRM_RESULT status code (0 for success).</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetRebalanceFraction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetRepresentativeVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetRepresentativeVolume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">rv</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetSaturation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sat</span><span class="p">):</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set water saturation values for all grid cells.</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">        Defines the water saturation for each grid cell, representing the</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">        fraction of pore space occupied by water. Saturation affects volume</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        calculations and is particularly important in unsaturated zone</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">        modeling where gas phase may occupy part of the pore space.</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">            sat (numpy.ndarray): Array of saturation values for each cell.</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">                Length should equal the number of grid cells (nxyz).</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">                Values must be between 0 and 1, where:</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">                - 0 = dry (no water in pores)</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">                - 1 = fully saturated (all pores filled with water)</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">                - Typical values: 0.1-1.0 depending on vadose zone conditions</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">            Water saturation is used with porosity to calculate the actual</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">            water volume: water_volume = porosity × saturation × bulk_volume.</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">            This directly affects solution concentrations and reaction rates.</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">            &gt;&gt;&gt; # Fully saturated conditions</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">            &gt;&gt;&gt; saturation = np.ones(nxyz)</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetSaturation(saturation)</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">            &gt;&gt;&gt; # Partially saturated (vadose zone)</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">            &gt;&gt;&gt; sat_profile = np.linspace(0.3, 1.0, nxyz)  # Increasing with depth</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetSaturation(sat_profile)</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetSaturation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sat</span><span class="o">.</span><span class="n">ctypes</span><span class="p">))</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetScreenOn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tf</span><span class="p">):</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetScreenOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetSelectedOutputOn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_output</span><span class="p">):</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetSelectedOutputOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">selected_output</span><span class="p">)</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetSpeciesSaveOn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_on</span><span class="p">):</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable saving of aqueous species concentrations.</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">        Controls whether PhreeqcRM calculates and stores individual aqueous</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">        species concentrations that can be retrieved with RM_GetSpeciesConcentrations().</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">        This provides detailed speciation information but increases memory usage</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><span class="sd">        and computation time.</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">            save_on (int): Species saving option:</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="sd">                1 = Enable species concentration saving</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a><span class="sd">                0 = Disable species saving (default, saves memory and time)</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><span class="sd">            When enabled, PhreeqcRM stores concentrations for all aqueous species</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">            after each call to RM_RunCells(). This is required for:</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">            - Multicomponent diffusion calculations</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">            - Detailed speciation analysis</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">            - Species-specific output and post-processing</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetSpeciesSaveOn(1)  # Enable species saving</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">            &gt;&gt;&gt; rm.RM_RunCells()  # Calculate with species saving</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">            &gt;&gt;&gt; species_conc = np.zeros(nxyz * nspecies)</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><span class="sd">            &gt;&gt;&gt; rm.RM_GetSpeciesConcentrations(species_conc)</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetSpeciesSaveOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">save_on</span><span class="p">))</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetTemperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current simulation time for geochemical calculations.</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><span class="sd">        Updates the simulation time used by PhreeqcRM for kinetic rate</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><span class="sd">        calculations and time-dependent processes. The time should be</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><span class="sd">        consistent with the time stepping in the transport model.</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><span class="sd">            time (float): Current simulation time in user-defined units.</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a><span class="sd">                Units should be consistent with kinetic rate constants</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><span class="sd">                in the thermodynamic database (typically seconds, days, or years).</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">            This method should be called before each call to RM_RunCells()</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a><span class="sd">            to ensure kinetic calculations use the correct time. The time</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">            is used to integrate kinetic rate equations over the time step.</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">            &gt;&gt;&gt; for step in range(num_steps):</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">            &gt;&gt;&gt;     current_time = step * dt</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_SetTime(current_time)</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_SetTimeStep(dt)</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">            &gt;&gt;&gt;     rm.RM_RunCells()</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetTimeConversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conv_factor</span><span class="p">):</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetTimeConversion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">conv_factor</span><span class="p">))</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetTimeStep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="p">):</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the time step duration for kinetic calculations.</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">        Specifies the time interval over which kinetic reactions will be</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">        integrated during the next call to RM_RunCells(). The time step</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">        affects the accuracy of kinetic calculations.</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">            time_step (float): Time step duration in user-defined units.</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                Must be positive and consistent with simulation time units.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">                Smaller time steps provide better accuracy for fast kinetic</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">                reactions but increase computational cost.</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">            The time step is used for integrating kinetic rate equations.</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">            For stiff kinetic systems, smaller time steps may be required</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">            for numerical stability and accuracy.</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            &gt;&gt;&gt; dt = 0.1  # 0.1 day time step</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetTimeStep(dt)</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">            &gt;&gt;&gt; rm.RM_RunCells()  # Integrate kinetics over dt</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetTimeStep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">(</span><span class="n">time_step</span><span class="p">)))</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsExchange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set units for exchange reactions.</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">            option (int): Units option for exchange calculations.</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">            int: IRM_RESULT status code (0 for success).</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsExchange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">))</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsGasPhase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsGasPhase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsKinetics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsKinetics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsPPassemblage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsPPassemblage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsSolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set concentration units for aqueous solutions.</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a><span class="sd">        Specifies the units for solution concentrations used in all</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a><span class="sd">        concentration transfers between the transport model and PhreeqcRM.</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a><span class="sd">        This affects how concentration data is interpreted and returned.</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="sd">            option (int): Units option for solution concentrations:</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="sd">                1 = mol/L (molar)</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">                2 = mmol/L (millimolar) - commonly used</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">                3 = μmol/L (micromolar) - for trace species</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">            IRMStatus: Status object with code, name, and message. Use bool(result) to check success.</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">            This setting affects:</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">            - RM_SetConcentrations() input interpretation</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">            - RM_GetConcentrations() output units</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a><span class="sd">            - RM_GetSpeciesConcentrations() output units</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">            - Initial condition concentration scaling</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetUnitsSolution(2)  # Use mmol/L</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><span class="sd">            &gt;&gt;&gt; # Now all concentrations are in millimolar units</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="sd">            &gt;&gt;&gt; conc_mmol = np.array([1.0, 0.5, 2.0])  # 1, 0.5, 2 mmol/L</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a><span class="sd">            &gt;&gt;&gt; rm.RM_SetConcentrations(conc_mmol)</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsSolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">))</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsSSassemblage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsSSassemblage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SetUnitsSurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set units for surface complexation reactions.</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">            option (int): Units option for surface calculations.</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><span class="sd">            int: IRM_RESULT status code (0 for success).</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>        <span class="k">return</span> <span class="n">IRM_RESULT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SetUnitsSurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">option</span><span class="p">))</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_SpeciesConcentrations2Module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">species_conc</span><span class="p">):</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_SpeciesConcentrations2Module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">species_conc</span><span class="o">.</span><span class="n">ctypes</span><span class="p">)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_UseSolutionDensityVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tf</span><span class="p">):</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_UseSolutionDensityVolume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_WarningMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warn_str</span><span class="p">):</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_WarningMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">warn_str</span><span class="p">)</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">RM_GetComponentCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of transport components in the system.</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">        Returns the number of chemical components (elements plus charge balance)</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><span class="sd">        that must be transported in reactive transport simulations. This count</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a><span class="sd">        is determined after calling RM_FindComponents() and defines the size</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a><span class="sd">        of concentration arrays.</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a><span class="sd">            int: Number of transport components, which includes:</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a><span class="sd">                - Chemical elements present in the system (e.g., Ca, Cl, C)</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a><span class="sd">                - Electric charge balance component</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><span class="sd">                - Isotopes if defined in the database</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="sd">                - Excludes H2O unless RM_SetComponentH2O(1) was called</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><span class="sd">            This method should be called after RM_FindComponents() to get the</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">            correct component count. The returned value determines array sizes</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">            for RM_SetConcentrations() and RM_GetConcentrations().</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="sd">            &gt;&gt;&gt; rm.run_initial_from_file(&quot;initial.pqi&quot;, ic_array)</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="sd">            &gt;&gt;&gt; ncomp = rm.RM_GetComponentCount()</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">            &gt;&gt;&gt; conc_array = np.zeros(nxyz * ncomp)</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">            &gt;&gt;&gt; rm.RM_GetConcentrations(conc_array)</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_GetComponentCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mibiremo.phreeqc.PhreeqcRM.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize PhreeqcRM instance.</p>
<p>Creates a new PhreeqcRM object with default values. The instance must be
created using the create() method before it can be used for calculations.</p>


            <details class="quote">
              <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize PhreeqcRM instance.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Creates a new PhreeqcRM object with default values. The instance must be</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    created using the create() method before it can be used for calculations.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dllpath</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_threads</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">libc</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.phreeqc.PhreeqcRM.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">dllpath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nxyz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creates a PhreeqcRM reaction module instance.</p>
<p>Initializes the PhreeqcRM library, loads the dynamic library, and creates
a reaction module with the specified number of grid cells and threads.
This method must be called before any other PhreeqcRM operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dllpath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the PhreeqcRM library. If None,
uses the default library path based on the operating system.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nxyz</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of grid cells in the model. Must be
positive. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of threads for parallel processing.
Use -1 for automatic detection of CPU count. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the operating system is not supported (Windows/Linux only).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If PhreeqcRM instance creation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span> <span class="o">=</span> <span class="n">PhreeqcRM</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">nxyz</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dllpath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nxyz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a PhreeqcRM reaction module instance.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Initializes the PhreeqcRM library, loads the dynamic library, and creates</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    a reaction module with the specified number of grid cells and threads.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    This method must be called before any other PhreeqcRM operations.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        dllpath (str, optional): Path to the PhreeqcRM library. If None,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            uses the default library path based on the operating system.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        nxyz (int, optional): Number of grid cells in the model. Must be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            positive. Defaults to 1.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        n_threads (int, optional): Number of threads for parallel processing.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            Use -1 for automatic detection of CPU count. Defaults to 1.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        Exception: If the operating system is not supported (Windows/Linux only).</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        RuntimeError: If PhreeqcRM instance creation fails.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        &gt;&gt;&gt; rm.create(nxyz=100, n_threads=4)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">if</span> <span class="n">dllpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># If no path is provided, use the default path, based on operating system</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="n">dllpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;PhreeqcRM.dll&quot;</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">dllpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;PhreeqcRM.so&quot;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Operating system not supported&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dllpath</span> <span class="o">=</span> <span class="n">dllpath</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">n_threads</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">n_threads</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_threads</span> <span class="o">=</span> <span class="n">n_threads</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">=</span> <span class="n">nxyz</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">libc</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="n">dllpath</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">libc</span><span class="o">.</span><span class="n">RM_Create</span><span class="p">(</span><span class="n">nxyz</span><span class="p">,</span> <span class="n">n_threads</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to create PhreeqcRM instance: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.phreeqc.PhreeqcRM.get_selected_output_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_selected_output_df</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve selected output data as a pandas DataFrame.</p>
<p>Extracts the current selected output data from PhreeqcRM and formats it
as a pandas DataFrame with appropriate column headers. Selected output
typically includes calculated properties like pH, pe, ionic strength,
activities, saturation indices, and user-defined calculations.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas.DataFrame: DataFrame containing selected output data with
rows representing grid cells and columns representing the
selected output variables defined in the PHREEQC input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">get_selected_output_df</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Show available output variables</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">])</span>     <span class="c1"># Access pH values for all cells</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_selected_output_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve selected output data as a pandas DataFrame.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    Extracts the current selected output data from PhreeqcRM and formats it</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    as a pandas DataFrame with appropriate column headers. Selected output</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    typically includes calculated properties like pH, pe, ionic strength,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    activities, saturation indices, and user-defined calculations.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        pandas.DataFrame: DataFrame containing selected output data with</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            rows representing grid cells and columns representing the</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            selected output variables defined in the PHREEQC input.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        &gt;&gt;&gt; df = rm.get_selected_output_df()</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        &gt;&gt;&gt; print(df.columns)  # Show available output variables</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        &gt;&gt;&gt; print(df[&#39;pH&#39;])     # Access pH values for all cells</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="c1"># Get selected ouput headings</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">ncolsel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutputColumnCount</span><span class="p">()</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">selout_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U100&quot;</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">):</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutputHeading</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">selout_h</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">so</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncolsel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span> <span class="n">ncolsel</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSelectedOutput</span><span class="p">(</span><span class="n">so</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ncolsel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">selout_h</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.phreeqc.PhreeqcRM.initialize_phreeqc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_phreeqc</span><span class="p">(</span><span class="n">database_path</span><span class="p">,</span> <span class="n">units_solution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">porosity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">multicomponent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize PhreeqcRM with database and default parameters.</p>
<p>Loads a thermodynamic database and sets up the PhreeqcRM instance with
standard parameters for geochemical calculations. This is a convenience
method that handles common initialization tasks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>database_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the PHREEQC database file (.dat format).
Common databases include phreeqc.dat, Amm.dat, pitzer.dat.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>units_solution</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Units for solution concentrations.
1 = mol/L, 2 = mmol/L, 3 = μmol/L. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>units</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Units for other phases (Exchange, Surface,
Gas, Solid solutions, Kinetics). Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>porosity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Porosity value assigned to all cells.
Must be between 0 and 1. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>saturation</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Saturation value assigned to all cells.
Must be between 0 and 1. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multicomponent</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable multicomponent diffusion
by saving species concentrations. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PhreeqcRM instance is not initialized or if
the database fails to load.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span> <span class="o">=</span> <span class="n">PhreeqcRM</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">nxyz</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span><span class="o">.</span><span class="n">initialize_phreeqc</span><span class="p">(</span><span class="s2">&quot;phreeqc.dat&quot;</span><span class="p">,</span> <span class="n">units_solution</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_phreeqc</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">database_path</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">units_solution</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">porosity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">saturation</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">multicomponent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize PhreeqcRM with database and default parameters.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Loads a thermodynamic database and sets up the PhreeqcRM instance with</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    standard parameters for geochemical calculations. This is a convenience</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    method that handles common initialization tasks.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        database_path (str): Path to the PHREEQC database file (.dat format).</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            Common databases include phreeqc.dat, Amm.dat, pitzer.dat.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        units_solution (int, optional): Units for solution concentrations.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            1 = mol/L, 2 = mmol/L, 3 = μmol/L. Defaults to 2.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        units (int, optional): Units for other phases (Exchange, Surface,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            Gas, Solid solutions, Kinetics). Defaults to 1.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        porosity (float, optional): Porosity value assigned to all cells.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            Must be between 0 and 1. Defaults to 1.0.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        saturation (float, optional): Saturation value assigned to all cells.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            Must be between 0 and 1. Defaults to 1.0.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        multicomponent (bool, optional): Enable multicomponent diffusion</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            by saving species concentrations. Defaults to True.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        RuntimeError: If the PhreeqcRM instance is not initialized or if</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            the database fails to load.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        &gt;&gt;&gt; rm = PhreeqcRM()</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        &gt;&gt;&gt; rm.create(nxyz=100)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; rm.initialize_phreeqc(&quot;phreeqc.dat&quot;, units_solution=1)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;PhreeqcRM instance not initialized. Call create() first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="c1"># Load database</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_LoadDatabase</span><span class="p">(</span><span class="n">database_path</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load Phreeqc database: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="c1"># Set properties/parameters</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetComponentH2O</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Don&#39;t include H2O in component list</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetRebalanceFraction</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Rebalance thread load</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="c1"># Set units</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSolution</span><span class="p">(</span><span class="n">units_solution</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsPPassemblage</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsExchange</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSurface</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsGasPhase</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsSSassemblage</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetUnitsKinetics</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="c1"># Set porosity and saturation</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetPorosity</span><span class="p">(</span><span class="n">porosity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">))</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetSaturation</span><span class="p">(</span><span class="n">saturation</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">))</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># Create error log files</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetFilePrefix</span><span class="p">(</span><span class="s2">&quot;phr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_OpenFiles</span><span class="p">()</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="c1"># Multicomponent diffusion settings</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">if</span> <span class="n">multicomponent</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetSpeciesSaveOn</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.phreeqc.PhreeqcRM.run_initial_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_initial_from_file</span><span class="p">(</span><span class="n">pqi_file</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set up initial conditions from PHREEQC input file and initial conditions array.</p>
<p>Loads initial geochemical conditions by running a PHREEQC input file and
mapping the defined solutions, phases, and other components to the grid cells.
This method also retrieves component and species information for later use.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pqi_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the PHREEQC input file (.pqi format) containing
definitions for solutions, equilibrium phases, exchange, surface,
gas phases, solid solutions, and kinetic reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ic</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial conditions array with shape (nxyz, 7) where
each row corresponds to a grid cell and columns represent:
- Column 0: Solution ID
- Column 1: Equilibrium phase ID
- Column 2: Exchange ID
- Column 3: Surface ID
- Column 4: Gas phase ID
- Column 5: Solid solution ID
- Column 6: Kinetic reaction ID
Use -1 for unused components.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PHREEQC input file fails to run.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If initial conditions array has incorrect shape or cannot
be converted to integer array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Only solution 1</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rm</span><span class="o">.</span><span class="n">run_initial_from_file</span><span class="p">(</span><span class="s2">&quot;initial.pqi&quot;</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/phreeqc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_initial_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pqi_file</span><span class="p">,</span> <span class="n">ic</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up initial conditions from PHREEQC input file and initial conditions array.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Loads initial geochemical conditions by running a PHREEQC input file and</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    mapping the defined solutions, phases, and other components to the grid cells.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    This method also retrieves component and species information for later use.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        pqi_file (str): Path to the PHREEQC input file (.pqi format) containing</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            definitions for solutions, equilibrium phases, exchange, surface,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            gas phases, solid solutions, and kinetic reactions.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        ic (numpy.ndarray): Initial conditions array with shape (nxyz, 7) where</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            each row corresponds to a grid cell and columns represent:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            - Column 0: Solution ID</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            - Column 1: Equilibrium phase ID</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            - Column 2: Exchange ID</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            - Column 3: Surface ID</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            - Column 4: Gas phase ID</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            - Column 5: Solid solution ID</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            - Column 6: Kinetic reaction ID</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            Use -1 for unused components.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        RuntimeError: If the PHREEQC input file fails to run.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        ValueError: If initial conditions array has incorrect shape or cannot</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            be converted to integer array.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        &gt;&gt;&gt; ic = np.array([[1, -1, -1, -1, -1, -1, -1]])  # Only solution 1</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        &gt;&gt;&gt; rm.run_initial_from_file(&quot;initial.pqi&quot;, ic)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="c1"># Run the initial setup file</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_RunFile</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pqi_file</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to run Phreeqc input file: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="c1"># Check size of initial conditions array</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">if</span> <span class="n">ic</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial conditions array must have shape (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span><span class="si">}</span><span class="s2">, 7), got </span><span class="si">{</span><span class="n">ic</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="c1"># Be sure that ic is a numpy array</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Initial conditions must be convertible to a numpy array of integers&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="c1"># Reshape initial conditions to 1D array</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">ic1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="c1"># ic2 contains numbers for a second entity that mixes with the first entity (here, it is not used)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">ic2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="c1"># f1 contains the fractions of the first entity in each cell (here, it is set to 1.0)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxyz</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_InitialPhreeqc2Module</span><span class="p">(</span><span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="c1"># Get component and species information</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">n_comps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_FindComponents</span><span class="p">()</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">n_species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSpeciesCount</span><span class="p">()</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_comps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U20&quot;</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comps</span><span class="p">):</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetComponent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_species</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U20&quot;</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_species</span><span class="p">):</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">RM_GetSpeciesName</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="c1"># Run initial equilibrium step</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetTime</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">RM_SetTimeStep</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RM_RunCells</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mibiremo.semilagsolver" class="doc doc-heading">
            <code>semilagsolver</code>


</h2>

    <div class="doc doc-contents ">

        <p>Semi-Lagrangian solver for 1D advection-diffusion equation on a uniform grid.</p>
<p>Author: Matteo Masi
Last revision: 09/09/2024</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="mibiremo.semilagsolver.SemiLagSolver" class="doc doc-heading">
            <code>SemiLagSolver</code>


</h3>


    <div class="doc doc-contents ">


        <p>Semi-Lagrangian solver for 1D advection-diffusion transport equations.</p>
<p>This class implements a semi-Lagrangian numerical scheme for solving the
one-dimensional advection-diffusion equation on uniform grids. The solver
uses operator splitting to handle advection and diffusion separately,
providing accurate and stable solutions for transport problems.</p>


<details class="the-numerical-approach-consists-of-two-sequential-steps" open>
  <summary>The numerical approach consists of two sequential steps</summary>
  <ol>
<li><strong>Advection</strong>: Solved using the Method of Characteristics (MOC) with
   cubic spline interpolation (PCHIP - Piecewise Cubic Hermite Interpolating
   Polynomial) to maintain monotonicity and prevent oscillations.</li>
<li><strong>Diffusion</strong>: Solved using the Saul&rsquo;yev alternating direction method,
   which provides unconditional stability for the diffusion equation.</li>
</ol>
</details>

<details class="boundary-conditions" open>
  <summary>Boundary Conditions</summary>
  <ul>
<li><strong>Inlet (left boundary, x=0)</strong>: Dirichlet-type condition with prescribed
  concentration value.</li>
<li><strong>Outlet (right boundary)</strong>: Neumann-type condition (zero gradient) allowing
  natural outflow of transported species.</li>
</ul>
</details>

<details class="mathematical-formulation" open>
  <summary>Mathematical Formulation</summary>
  <p>The solver addresses the 1D advection-diffusion equation:</p>
<p>∂C/∂t + v∂C/∂x = D∂²C/∂x²</p>
<p>where:
- C(x,t): Concentration field
- v: Advection velocity (constant)
- D: Diffusion/dispersion coefficient (constant)</p>
</details>

<details class="numerical-stability" open>
  <summary>Numerical Stability</summary>
  <ul>
<li>The cubic spline advection step is stable for any Courant number</li>
<li>The Saul&rsquo;yev diffusion solver is unconditionally stable</li>
<li>Combined scheme maintains stability and accuracy for typical transport problems</li>
</ul>
</details>

<details class="applications" open>
  <summary>Applications</summary>
  <ul>
<li>Reactive transport modeling in porous media</li>
<li>Contaminant transport in groundwater systems</li>
<li>Chemical species transport in environmental flows</li>
<li>Coupling with geochemical reaction modules (e.g., PhreeqcRM)</li>
</ul>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.x">x</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spatial coordinate array (uniform spacing required).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.C">C</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current concentration field at grid points.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.v">v</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Advection velocity in consistent units with spatial coordinates.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.D">D</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Diffusion coefficient in consistent units (L²/T).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.dt">dt</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step for numerical integration in consistent time units.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mibiremo.semilagsolver.SemiLagSolver.dx">dx</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spatial grid spacing (automatically calculated from x).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The spatial grid must be uniformly spaced for the numerical scheme to
work correctly. Non-uniform grids are not supported in this implementation.</p>
</details>







              <details class="quote">
                <summary>Source code in <code>mibiremo/semilagsolver.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">SemiLagSolver</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Semi-Lagrangian solver for 1D advection-diffusion transport equations.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    This class implements a semi-Lagrangian numerical scheme for solving the</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    one-dimensional advection-diffusion equation on uniform grids. The solver</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    uses operator splitting to handle advection and diffusion separately,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    providing accurate and stable solutions for transport problems.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    The numerical approach consists of two sequential steps:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        1. **Advection**: Solved using the Method of Characteristics (MOC) with</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">           cubic spline interpolation (PCHIP - Piecewise Cubic Hermite Interpolating</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">           Polynomial) to maintain monotonicity and prevent oscillations.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        2. **Diffusion**: Solved using the Saul&#39;yev alternating direction method,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">           which provides unconditional stability for the diffusion equation.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Boundary Conditions:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        - **Inlet (left boundary, x=0)**: Dirichlet-type condition with prescribed</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">          concentration value.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        - **Outlet (right boundary)**: Neumann-type condition (zero gradient) allowing</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">          natural outflow of transported species.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Mathematical Formulation:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        The solver addresses the 1D advection-diffusion equation:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        ∂C/∂t + v∂C/∂x = D∂²C/∂x²</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        where:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        - C(x,t): Concentration field</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        - v: Advection velocity (constant)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        - D: Diffusion/dispersion coefficient (constant)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Numerical Stability:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        - The cubic spline advection step is stable for any Courant number</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        - The Saul&#39;yev diffusion solver is unconditionally stable</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        - Combined scheme maintains stability and accuracy for typical transport problems</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Applications:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        - Reactive transport modeling in porous media</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        - Contaminant transport in groundwater systems</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        - Chemical species transport in environmental flows</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        - Coupling with geochemical reaction modules (e.g., PhreeqcRM)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        x (numpy.ndarray): Spatial coordinate array (uniform spacing required).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        C (numpy.ndarray): Current concentration field at grid points.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        v (float): Advection velocity in consistent units with spatial coordinates.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        D (float): Diffusion coefficient in consistent units (L²/T).</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        dt (float): Time step for numerical integration in consistent time units.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        dx (float): Spatial grid spacing (automatically calculated from x).</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        The spatial grid must be uniformly spaced for the numerical scheme to</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        work correctly. Non-uniform grids are not supported in this implementation.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">C_init</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Semi-Lagrangian solver with transport parameters.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        Sets up the numerical solver with spatial discretization, initial conditions,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        and transport parameters. Validates input consistency and calculates derived</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        parameters needed for the numerical scheme.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            x (numpy.ndarray): Spatial coordinate array defining the 1D computational</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">                domain. Must be uniformly spaced with at least 2 points. Units should</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                be consistent with velocity and diffusion coefficient.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            C_init (numpy.ndarray): Initial concentration field at each grid point.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                Length must match the spatial coordinate array. Units are user-defined</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">                but should be consistent throughout the simulation.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            v (float): Advection velocity (positive for left-to-right flow).</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                Units must be consistent with spatial coordinates and time step</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                (e.g., if x is in meters and dt in days, v should be in m/day).</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            D (float): Diffusion/dispersion coefficient (must be non-negative).</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                Units must be L²/T where L and T are consistent with spatial</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                coordinates and time step (e.g., m²/day).</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            dt (float): Time step for numerical integration (must be positive).</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">                Units should be consistent with velocity and diffusion coefficient.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            ValueError: If spatial coordinates are not uniformly spaced or if</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                concentration array length doesn&#39;t match spatial coordinates.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            ValueError: If transport parameters are not physically reasonable</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                (negative diffusion, zero or negative time step).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            &gt;&gt;&gt; x = np.linspace(0, 5, 51)      # 5 m domain, 0.1 m spacing</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            &gt;&gt;&gt; C0 = np.exp(-x**2)             # Gaussian initial condition</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            &gt;&gt;&gt; solver = SemiLagSolver(x, C0, v=0.5, D=0.05, dt=0.01)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">C_init</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of x (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">) must match length of C_init (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">C_init</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid must have at least 2 points, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C_init</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cubic_spline_advection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Solve the advection step using cubic spline interpolation.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        Implements the Method of Characteristics (MOC) for the advection equation</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        ∂C/∂t + v∂C/∂x = 0 using backward tracking of characteristic lines.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Uses PCHIP (Piecewise Cubic Hermite Interpolating Polynomial) to maintain</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        monotonicity and prevent numerical oscillations.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        The method works by:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            1. Computing departure points: xi = x - v*dt (backward tracking)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            2. Interpolating concentrations at departure points using cubic splines</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            3. Applying inlet boundary condition for points that tracked outside domain</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            C_bound (float): Inlet concentration value applied at the left boundary</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                (x=0) for any characteristic lines that originated from outside the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                computational domain. Units should match the concentration field.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            This method modifies self.C in-place. The cubic spline interpolation</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            preserves monotonicity, making it suitable for concentration fields</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            where spurious oscillations must be avoided.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Numerical Properties:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            - Unconditionally stable (no CFL restriction)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            - Maintains monotonicity (no new extrema created)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            - Handles arbitrary Courant numbers (v*dt/dx)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            - Exact for linear concentration profiles</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">cs</span> <span class="o">=</span> <span class="n">PchipInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">shift</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">k0</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">xi</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">yi</span> <span class="o">=</span> <span class="n">cs</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">yi</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C_bound</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">yi</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">saulyev_solver_alt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Solve the diffusion step using the Saul&#39;yev alternating direction method.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        Implements the Saul&#39;yev scheme for the diffusion equation ∂C/∂t = D∂²C/∂x²</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        using alternating direction sweeps to achieve unconditional stability.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        The method performs two passes:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            1. Left-to-right sweep using forward differences</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            2. Right-to-left sweep using backward differences</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            3. Final solution is the average of both sweeps</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            C_bound (float): Inlet concentration value applied at the left boundary</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                during the diffusion solve. This maintains consistency with the</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                advection boundary condition.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Algorithm Details:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            - **Left-to-Right Pass**: For each cell i, uses implicit treatment of</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">              left neighbor and explicit treatment of right neighbor</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            - **Right-to-Left Pass**: For each cell i, uses implicit treatment of</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">              right neighbor and explicit treatment of left neighbor</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            - **Averaging**: Combines both solutions to achieve second-order accuracy</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Boundary Conditions:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            - **Left boundary (x=0)**: Dirichlet condition with prescribed C_bound</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            - **Right boundary**: Zero gradient (Neumann) condition implemented</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">              by using the same concentration as the last interior point</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        Numerical Properties:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            - Unconditionally stable for any time step size</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            - Second-order accurate in space and time</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            - Preserves maximum principle (no spurious extrema)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            - Handles arbitrary diffusion numbers (D*dt/dx²)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            This method modifies self.C in-place. The alternating direction</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            approach eliminates the restrictive stability constraint of explicit</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            methods while maintaining computational efficiency.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># Assign current C state as initial condition</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">C_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">CLR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">CRL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="c1"># A) L-R direction</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CLR</span><span class="p">)):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># left boundary</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_bound</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CLR</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">solB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">solC</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">CLR</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="c1"># L-R Solution</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">CLR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">solA</span> <span class="o">+</span> <span class="n">solB</span> <span class="o">+</span> <span class="n">solC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="c1"># B) R-L direction</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CRL</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">CRL</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># right boundary (take from LR solution)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CLR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CRL</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="n">solB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">solC</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="c1"># R-L Solution</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">CRL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">solA</span> <span class="o">+</span> <span class="n">solB</span> <span class="o">+</span> <span class="n">solC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1"># Average L-R and R-L solutions and update to final state</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">CLR</span> <span class="o">+</span> <span class="n">CRL</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">transport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform one complete transport time step with coupled advection-diffusion.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        Executes the full semi-Lagrangian algorithm by sequentially applying</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        the advection and diffusion operators using operator splitting. This</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        approach decouples the hyperbolic (advection) and parabolic (diffusion)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        aspects of the transport equation for enhanced numerical stability.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        The operator splitting sequence:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            1. **Advection Step** using cubic spline MOC</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            2. **Diffusion Step** using Saul&#39;yev method</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            C_bound (float): Inlet boundary concentration applied at x=0 for both</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">                advection and diffusion steps. This represents the concentration</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">                of material entering the domain (e.g., injection well concentration,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">                upstream boundary condition, etc.).</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            numpy.ndarray: Updated concentration field after the complete transport</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">                step. The array has the same shape as the initial concentration</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                and represents C(x, t+dt).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            This method updates the internal concentration field (self.C) and</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            returns the updated values. For reactive transport coupling, call</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            this method to advance transport, then apply geochemical reactions</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            to the returned concentration field.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="c1"># Step 1: Solve advection equation using cubic spline MOC</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cubic_spline_advection</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># Step 2: Solve diffusion equation using Saul&#39;yev alternating direction method</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">saulyev_solver_alt</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="mibiremo.semilagsolver.SemiLagSolver.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C_init</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize the Semi-Lagrangian solver with transport parameters.</p>
<p>Sets up the numerical solver with spatial discretization, initial conditions,
and transport parameters. Validates input consistency and calculates derived
parameters needed for the numerical scheme.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spatial coordinate array defining the 1D computational
domain. Must be uniformly spaced with at least 2 points. Units should
be consistent with velocity and diffusion coefficient.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>C_init</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial concentration field at each grid point.
Length must match the spatial coordinate array. Units are user-defined
but should be consistent throughout the simulation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Advection velocity (positive for left-to-right flow).
Units must be consistent with spatial coordinates and time step
(e.g., if x is in meters and dt in days, v should be in m/day).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>D</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Diffusion/dispersion coefficient (must be non-negative).
Units must be L²/T where L and T are consistent with spatial
coordinates and time step (e.g., m²/day).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step for numerical integration (must be positive).
Units should be consistent with velocity and diffusion coefficient.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If spatial coordinates are not uniformly spaced or if
concentration array length doesn&rsquo;t match spatial coordinates.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If transport parameters are not physically reasonable
(negative diffusion, zero or negative time step).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>      <span class="c1"># 5 m domain, 0.1 m spacing</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">C0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>             <span class="c1"># Gaussian initial condition</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">SemiLagSolver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>mibiremo/semilagsolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">C_init</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Semi-Lagrangian solver with transport parameters.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Sets up the numerical solver with spatial discretization, initial conditions,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    and transport parameters. Validates input consistency and calculates derived</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    parameters needed for the numerical scheme.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        x (numpy.ndarray): Spatial coordinate array defining the 1D computational</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            domain. Must be uniformly spaced with at least 2 points. Units should</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            be consistent with velocity and diffusion coefficient.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        C_init (numpy.ndarray): Initial concentration field at each grid point.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            Length must match the spatial coordinate array. Units are user-defined</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            but should be consistent throughout the simulation.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        v (float): Advection velocity (positive for left-to-right flow).</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            Units must be consistent with spatial coordinates and time step</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            (e.g., if x is in meters and dt in days, v should be in m/day).</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        D (float): Diffusion/dispersion coefficient (must be non-negative).</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            Units must be L²/T where L and T are consistent with spatial</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            coordinates and time step (e.g., m²/day).</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        dt (float): Time step for numerical integration (must be positive).</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            Units should be consistent with velocity and diffusion coefficient.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ValueError: If spatial coordinates are not uniformly spaced or if</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            concentration array length doesn&#39;t match spatial coordinates.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        ValueError: If transport parameters are not physically reasonable</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            (negative diffusion, zero or negative time step).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &gt;&gt;&gt; x = np.linspace(0, 5, 51)      # 5 m domain, 0.1 m spacing</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &gt;&gt;&gt; C0 = np.exp(-x**2)             # Gaussian initial condition</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        &gt;&gt;&gt; solver = SemiLagSolver(x, C0, v=0.5, D=0.05, dt=0.01)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">C_init</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of x (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">) must match length of C_init (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">C_init</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid must have at least 2 points, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C_init</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.semilagsolver.SemiLagSolver.cubic_spline_advection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cubic_spline_advection</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Solve the advection step using cubic spline interpolation.</p>
<p>Implements the Method of Characteristics (MOC) for the advection equation
∂C/∂t + v∂C/∂x = 0 using backward tracking of characteristic lines.
Uses PCHIP (Piecewise Cubic Hermite Interpolating Polynomial) to maintain
monotonicity and prevent numerical oscillations.</p>


<details class="the-method-works-by" open>
  <summary>The method works by</summary>
  <ol>
<li>Computing departure points: xi = x - v*dt (backward tracking)</li>
<li>Interpolating concentrations at departure points using cubic splines</li>
<li>Applying inlet boundary condition for points that tracked outside domain</li>
</ol>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>C_bound</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inlet concentration value applied at the left boundary
(x=0) for any characteristic lines that originated from outside the
computational domain. Units should match the concentration field.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method modifies self.C in-place. The cubic spline interpolation
preserves monotonicity, making it suitable for concentration fields
where spurious oscillations must be avoided.</p>
</details>

<details class="numerical-properties" open>
  <summary>Numerical Properties</summary>
  <ul>
<li>Unconditionally stable (no CFL restriction)</li>
<li>Maintains monotonicity (no new extrema created)</li>
<li>Handles arbitrary Courant numbers (v*dt/dx)</li>
<li>Exact for linear concentration profiles</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>mibiremo/semilagsolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="k">def</span><span class="w"> </span><span class="nf">cubic_spline_advection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve the advection step using cubic spline interpolation.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    Implements the Method of Characteristics (MOC) for the advection equation</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    ∂C/∂t + v∂C/∂x = 0 using backward tracking of characteristic lines.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Uses PCHIP (Piecewise Cubic Hermite Interpolating Polynomial) to maintain</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    monotonicity and prevent numerical oscillations.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    The method works by:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        1. Computing departure points: xi = x - v*dt (backward tracking)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        2. Interpolating concentrations at departure points using cubic splines</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        3. Applying inlet boundary condition for points that tracked outside domain</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        C_bound (float): Inlet concentration value applied at the left boundary</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            (x=0) for any characteristic lines that originated from outside the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            computational domain. Units should match the concentration field.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        This method modifies self.C in-place. The cubic spline interpolation</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        preserves monotonicity, making it suitable for concentration fields</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        where spurious oscillations must be avoided.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Numerical Properties:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        - Unconditionally stable (no CFL restriction)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        - Maintains monotonicity (no new extrema created)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        - Handles arbitrary Courant numbers (v*dt/dx)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        - Exact for linear concentration profiles</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">cs</span> <span class="o">=</span> <span class="n">PchipInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">shift</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">k0</span> <span class="o">=</span> <span class="n">xi</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">xi</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">yi</span> <span class="o">=</span> <span class="n">cs</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">yi</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C_bound</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">yi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.semilagsolver.SemiLagSolver.saulyev_solver_alt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">saulyev_solver_alt</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Solve the diffusion step using the Saul&rsquo;yev alternating direction method.</p>
<p>Implements the Saul&rsquo;yev scheme for the diffusion equation ∂C/∂t = D∂²C/∂x²
using alternating direction sweeps to achieve unconditional stability.
The method performs two passes:
    1. Left-to-right sweep using forward differences
    2. Right-to-left sweep using backward differences
    3. Final solution is the average of both sweeps</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>C_bound</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inlet concentration value applied at the left boundary
during the diffusion solve. This maintains consistency with the
advection boundary condition.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="algorithm-details" open>
  <summary>Algorithm Details</summary>
  <ul>
<li><strong>Left-to-Right Pass</strong>: For each cell i, uses implicit treatment of
  left neighbor and explicit treatment of right neighbor</li>
<li><strong>Right-to-Left Pass</strong>: For each cell i, uses implicit treatment of
  right neighbor and explicit treatment of left neighbor</li>
<li><strong>Averaging</strong>: Combines both solutions to achieve second-order accuracy</li>
</ul>
</details>

<details class="boundary-conditions" open>
  <summary>Boundary Conditions</summary>
  <ul>
<li><strong>Left boundary (x=0)</strong>: Dirichlet condition with prescribed C_bound</li>
<li><strong>Right boundary</strong>: Zero gradient (Neumann) condition implemented
  by using the same concentration as the last interior point</li>
</ul>
</details>

<details class="numerical-properties" open>
  <summary>Numerical Properties</summary>
  <ul>
<li>Unconditionally stable for any time step size</li>
<li>Second-order accurate in space and time</li>
<li>Preserves maximum principle (no spurious extrema)</li>
<li>Handles arbitrary diffusion numbers (D*dt/dx²)</li>
</ul>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This method modifies self.C in-place. The alternating direction
approach eliminates the restrictive stability constraint of explicit
methods while maintaining computational efficiency.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>mibiremo/semilagsolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="k">def</span><span class="w"> </span><span class="nf">saulyev_solver_alt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve the diffusion step using the Saul&#39;yev alternating direction method.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Implements the Saul&#39;yev scheme for the diffusion equation ∂C/∂t = D∂²C/∂x²</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    using alternating direction sweeps to achieve unconditional stability.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    The method performs two passes:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        1. Left-to-right sweep using forward differences</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        2. Right-to-left sweep using backward differences</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        3. Final solution is the average of both sweeps</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        C_bound (float): Inlet concentration value applied at the left boundary</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            during the diffusion solve. This maintains consistency with the</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            advection boundary condition.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Algorithm Details:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        - **Left-to-Right Pass**: For each cell i, uses implicit treatment of</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">          left neighbor and explicit treatment of right neighbor</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        - **Right-to-Left Pass**: For each cell i, uses implicit treatment of</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">          right neighbor and explicit treatment of left neighbor</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        - **Averaging**: Combines both solutions to achieve second-order accuracy</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    Boundary Conditions:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        - **Left boundary (x=0)**: Dirichlet condition with prescribed C_bound</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        - **Right boundary**: Zero gradient (Neumann) condition implemented</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">          by using the same concentration as the last interior point</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Numerical Properties:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        - Unconditionally stable for any time step size</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        - Second-order accurate in space and time</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        - Preserves maximum principle (no spurious extrema)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        - Handles arbitrary diffusion numbers (D*dt/dx²)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        This method modifies self.C in-place. The alternating direction</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        approach eliminates the restrictive stability constraint of explicit</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        methods while maintaining computational efficiency.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Assign current C state as initial condition</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">C_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">CLR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">CRL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="c1"># A) L-R direction</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CLR</span><span class="p">)):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># left boundary</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_bound</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CLR</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">solB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">solC</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">CLR</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="c1"># L-R Solution</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">CLR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">solA</span> <span class="o">+</span> <span class="n">solB</span> <span class="o">+</span> <span class="n">solC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1"># B) R-L direction</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CRL</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">CRL</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># right boundary (take from LR solution)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CLR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="n">solA</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">CRL</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">solB</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">solC</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">theta</span> <span class="o">*</span> <span class="n">C_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># R-L Solution</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">CRL</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">solA</span> <span class="o">+</span> <span class="n">solB</span> <span class="o">+</span> <span class="n">solC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Average L-R and R-L solutions and update to final state</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">CLR</span> <span class="o">+</span> <span class="n">CRL</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibiremo.semilagsolver.SemiLagSolver.transport" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transport</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Perform one complete transport time step with coupled advection-diffusion.</p>
<p>Executes the full semi-Lagrangian algorithm by sequentially applying
the advection and diffusion operators using operator splitting. This
approach decouples the hyperbolic (advection) and parabolic (diffusion)
aspects of the transport equation for enhanced numerical stability.</p>


<details class="the-operator-splitting-sequence" open>
  <summary>The operator splitting sequence</summary>
  <ol>
<li><strong>Advection Step</strong> using cubic spline MOC</li>
<li><strong>Diffusion Step</strong> using Saul&rsquo;yev method</li>
</ol>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>C_bound</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inlet boundary concentration applied at x=0 for both
advection and diffusion steps. This represents the concentration
of material entering the domain (e.g., injection well concentration,
upstream boundary condition, etc.).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy.ndarray: Updated concentration field after the complete transport
step. The array has the same shape as the initial concentration
and represents C(x, t+dt).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method updates the internal concentration field (self.C) and
returns the updated values. For reactive transport coupling, call
this method to advance transport, then apply geochemical reactions
to the returned concentration field.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>mibiremo/semilagsolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="k">def</span><span class="w"> </span><span class="nf">transport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">C_bound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform one complete transport time step with coupled advection-diffusion.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Executes the full semi-Lagrangian algorithm by sequentially applying</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    the advection and diffusion operators using operator splitting. This</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    approach decouples the hyperbolic (advection) and parabolic (diffusion)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    aspects of the transport equation for enhanced numerical stability.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    The operator splitting sequence:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        1. **Advection Step** using cubic spline MOC</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        2. **Diffusion Step** using Saul&#39;yev method</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        C_bound (float): Inlet boundary concentration applied at x=0 for both</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            advection and diffusion steps. This represents the concentration</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            of material entering the domain (e.g., injection well concentration,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            upstream boundary condition, etc.).</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        numpy.ndarray: Updated concentration field after the complete transport</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            step. The array has the same shape as the initial concentration</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            and represents C(x, t+dt).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        This method updates the internal concentration field (self.C) and</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        returns the updated values. For reactive transport coupling, call</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        this method to advance transport, then apply geochemical reactions</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        to the returned concentration field.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="c1"># Step 1: Solve advection equation using cubic spline MOC</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cubic_spline_advection</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="c1"># Step 2: Solve diffusion equation using Saul&#39;yev alternating direction method</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">saulyev_solver_alt</span><span class="p">(</span><span class="n">C_bound</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025, MIBIREM Project
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/MiBiPreT/mibiremo" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../assets/fontawesome.min.js"></script>
      
        <script src="../assets/solid.min.js"></script>
      
        <script src="../assets/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>